
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Theory manual &#8212; capytaine 1.4.2 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/proof.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
    <script>mermaid.initialize({startOnLoad:true});</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bibliography" href="bibliography.html" />
    <link rel="prev" title="Theory manual" href="index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
<div id="old-doc-warning-banner" style="width:100%; background-color:#F0E68C; text-align: center;">This page is part of the documentation of an old version of Capytaine. <a href="https://capytaine.github.io/stable/">Latest stable version is available here.</a></div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="theory-manual">
<h1><a class="toc-backref" href="#id22" role="doc-backlink">Theory manual</a><a class="headerlink" href="#theory-manual" title="Permalink to this heading">¶</a></h1>
<p>This document presents several aspects of the theoretical background for Nemoh and Capytaine.
We refer also to <a class="reference internal" href="bibliography.html#del87" id="id1"><span>[Del87]</span></a> <a class="reference internal" href="bibliography.html#del89" id="id2"><span>[Del89]</span></a> <a class="reference internal" href="bibliography.html#del93" id="id3"><span>[Del93]</span></a> <a class="reference internal" href="bibliography.html#bd15" id="id4"><span>[BD15]</span></a> and <a class="reference internal" href="bibliography.html#ad18" id="id5"><span>[AD18]</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This document is a work in progress. It is incomplete and might
contain errors.</p>
</div>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#theory-manual" id="id22">Theory manual</a></p>
<ul>
<li><p><a class="reference internal" href="#linear-boundary-value-problem" id="id23">Linear boundary value problem</a></p>
<ul>
<li><p><a class="reference internal" href="#hypotheses" id="id24">Hypotheses</a></p></li>
<li><p><a class="reference internal" href="#mathematical-problem" id="id25">Mathematical problem</a></p></li>
<li><p><a class="reference internal" href="#integral-problem" id="id26">Integral problem</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#expression-of-the-green-function" id="id27">Expression of the Green function</a></p>
<ul>
<li><p><a class="reference internal" href="#in-infinite-depth" id="id28">In infinite depth</a></p>
<ul>
<li><p><a class="reference internal" href="#green-function" id="id29">Green function</a></p></li>
<li><p><a class="reference internal" href="#variants-of-the-formulation" id="id30">Variants of the formulation</a></p></li>
<li><p><a class="reference internal" href="#gradient-of-the-green-function" id="id31">Gradient of the Green function</a></p></li>
<li><p><a class="reference internal" href="#higher-order-derivative" id="id32">Higher order derivative</a></p></li>
<li><p><a class="reference internal" href="#delhommeau-s-method-for-computation" id="id33">Delhommeau’s method for computation</a></p></li>
<li><p><a class="reference internal" href="#xie-s-variant" id="id34">Xie’s variant</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#in-finite-depth" id="id35">In finite depth</a></p>
<ul>
<li><p><a class="reference internal" href="#id15" id="id36">Green function</a></p></li>
<li><p><a class="reference internal" href="#id16" id="id37">Gradient of the Green function</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#symmetries" id="id38">Symmetries</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#discretization" id="id39">Discretization</a></p></li>
<li><p><a class="reference internal" href="#post-processing" id="id40">Post-processing</a></p>
<ul>
<li><p><a class="reference internal" href="#forces-on-body-surfaces" id="id41">Forces on body surfaces</a></p></li>
<li><p><a class="reference internal" href="#dynamic-coupling-and-impedance" id="id42">Dynamic coupling and impedance</a></p></li>
<li><p><a class="reference internal" href="#free-surface-elevation" id="id43">Free surface elevation</a></p></li>
<li><p><a class="reference internal" href="#far-field-coefficients" id="id44">Far-field coefficients</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="linear-boundary-value-problem">
<h2><a class="toc-backref" href="#id23" role="doc-backlink">Linear boundary value problem</a><a class="headerlink" href="#linear-boundary-value-problem" title="Permalink to this heading">¶</a></h2>
<section id="hypotheses">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Hypotheses</a><a class="headerlink" href="#hypotheses" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>The fluid is inviscid.</p></li>
<li><p>The fluid is incompressible: <span class="math notranslate nohighlight">\(\nabla \cdot u = 0\)</span> with <span class="math notranslate nohighlight">\(u\)</span> the flow velocity.</p></li>
<li><p>The flow is irrotational: <span class="math notranslate nohighlight">\(\nabla \times u = 0\)</span>.</p></li>
<li><p>The wave amplitude is small with respect to the wavelength.</p></li>
<li><p>The amplitude of the body motion is small with respect to its dimension.</p></li>
<li><p>The sea bottom is flat. The water depth is denoted <span class="math notranslate nohighlight">\(h\)</span>.</p></li>
</ol>
</section>
<section id="mathematical-problem">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Mathematical problem</a><a class="headerlink" href="#mathematical-problem" title="Permalink to this heading">¶</a></h3>
<p>The mass conservation equation can be rewritten as the Laplace equation</p>
<div class="math notranslate nohighlight" id="equation-laplace">
<span class="eqno">(3)<a class="headerlink" href="#equation-laplace" title="Permalink to this equation">¶</a></span>\[\nabla^2 \phi = 0,\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> is the velocity potential defined as <span class="math notranslate nohighlight">\(u = \nabla \phi\)</span>.</p>
<p>Since the problem is linear, we look for a solution in the frequency domain:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-0">
<span class="eqno">(4)<a class="headerlink" href="#equation-theory-manual-theory-0" title="Permalink to this equation">¶</a></span>\[\phi = \mathrm{Re} \left( \Phi e^{-i \omega t} \right).\]</div>
<p>The partial differential equation <a class="reference internal" href="#equation-laplace">(3)</a> is completed with the following boundary conditions:</p>
<ul class="simple">
<li><p>linearized free surface boundary condition:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-bc-fs">
<span class="eqno">(5)<a class="headerlink" href="#equation-bc-fs" title="Permalink to this equation">¶</a></span>\[g \frac{\partial \Phi}{\partial z} - \omega^2 \Phi = 0, \qquad \text{on } z = 0.\]</div>
<ul class="simple">
<li><p>no velocity boundary condition at the (flat) sea bottom:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-bc-bottom">
<span class="eqno">(6)<a class="headerlink" href="#equation-bc-bottom" title="Permalink to this equation">¶</a></span>\[\frac{\partial \Phi}{\partial z} = 0, \qquad \text{on } z = -h.\]</div>
<ul class="simple">
<li><p>a given velocity <span class="math notranslate nohighlight">\(u\)</span> on the floating body surface <span class="math notranslate nohighlight">\(\Gamma\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-bc-body">
<span class="eqno">(7)<a class="headerlink" href="#equation-bc-body" title="Permalink to this equation">¶</a></span>\[\nabla \Phi \cdot n = u \cdot n, \qquad \text{on } \Gamma,\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> denotes the normal vector at the surface of the floating body.</p>
<p>The normal velocity on the floating body surface is the input of the problem.
It depends on the type of problem:</p>
<dl>
<dt><strong>Radiation problem</strong>:</dt><dd><p>For the radiation problem, the normal velocity on the body surface corresponds to the motion of the body along one of its degrees of freedom.
The resolution of the Laplace problem allows to derive the added mass and the radiation damping associated with this degree of freedom (see also <a class="reference internal" href="#post-processing">Post-processing</a>).</p>
</dd>
<dt><strong>Diffraction problem</strong>:</dt><dd><p>For the diffraction problem, the velocity on the floating body is given by the velocity of Airy’s wave field.
Once the problem has been solved, the linear Froude-Krylov force is computed by the integration of the pressure (<span class="math notranslate nohighlight">\(p = i \rho \omega \Phi\)</span>) on the floating body (see also <a class="reference internal" href="#post-processing">Post-processing</a>).</p>
<p>The incoming Airy’s wave fields is given by</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-1">
<span class="eqno">(8)<a class="headerlink" href="#equation-theory-manual-theory-1" title="Permalink to this equation">¶</a></span>\[\Phi_0 = - i \frac{g}{\omega} \frac{\cosh (m_0 (z+h))}{\cosh (m_0 h)} e^{i m_0 (x \cos \beta + y \sin \beta)}\]</div>
<p>in finite depth, where the wave number <span class="math notranslate nohighlight">\(m_0\)</span> is defined by the dispersion relation <span class="math notranslate nohighlight">\(\omega^2 = m_0 g \tanh (m_0 h)\)</span>, and by</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-2">
<span class="eqno">(9)<a class="headerlink" href="#equation-theory-manual-theory-2" title="Permalink to this equation">¶</a></span>\[\Phi_0 = - i \frac{g}{\omega} e^{k z} e^{i k (x \cos \beta + y \sin \beta)}\]</div>
<p>in infinite depth, where the wave number <span class="math notranslate nohighlight">\(k\)</span> is defined by <span class="math notranslate nohighlight">\(\omega^2 = k g\)</span>.</p>
<p>In the above equations, <span class="math notranslate nohighlight">\(\beta\)</span> is the angle of the incoming wave.
The angle <span class="math notranslate nohighlight">\(\beta = 0\)</span> corresponds to waves propagating in the <span class="math notranslate nohighlight">\(x\)</span> direction from <span class="math notranslate nohighlight">\(x=-\infty\)</span> to <span class="math notranslate nohighlight">\(x=+\infty\)</span>.
The angle <span class="math notranslate nohighlight">\(\beta = \pi/2\)</span> corresponds to waves propagating in the <span class="math notranslate nohighlight">\(y\)</span> direction from <span class="math notranslate nohighlight">\(y=-\infty\)</span> to <span class="math notranslate nohighlight">\(y=+\infty\)</span>.</p>
</dd>
</dl>
</section>
<section id="integral-problem">
<h3><a class="toc-backref" href="#id26" role="doc-backlink">Integral problem</a><a class="headerlink" href="#integral-problem" title="Permalink to this heading">¶</a></h3>
<p>The partial differential equation can be rewritten as a boundary integral problem.
Let us introduce the Green function <span class="math notranslate nohighlight">\(G(\xi, \cdot)\)</span>, which is solution of the partial differential equation:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-3">
<span class="eqno">(10)<a class="headerlink" href="#equation-theory-manual-theory-3" title="Permalink to this equation">¶</a></span>\[\nabla^2_x G(\xi, x) = \delta(\xi - x), \qquad \forall x,\]</div>
<p>associated with the boundary condition <a class="reference internal" href="#equation-bc-fs">(5)</a> and <a class="reference internal" href="#equation-bc-bottom">(6)</a>, where <span class="math notranslate nohighlight">\(\xi\)</span> is a given point in the domain and <span class="math notranslate nohighlight">\(\delta\)</span> is the Dirac distribution.</p>
<p>With the help of this Green function <span class="math notranslate nohighlight">\(G\)</span>, the potential of the surface of the floating body <span class="math notranslate nohighlight">\(\Gamma\)</span> can be rewritten as a function of a source distribution <span class="math notranslate nohighlight">\(\sigma\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-continuous-source-formulation">
<span class="eqno">(11)<a class="headerlink" href="#equation-continuous-source-formulation" title="Permalink to this equation">¶</a></span>\[\Phi(x) = \iint_\Gamma \sigma(y) G(x, y) \, \mathrm{dS}(y).\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a typo in this equation in <a class="reference internal" href="bibliography.html#bd15" id="id6"><span>[BD15]</span></a>.</p>
</div>
<p>The integral on the other boundaries of the domain is zero due to the properties of the Green function.</p>
<p>The differentiation of <a class="reference internal" href="#equation-continuous-source-formulation">(11)</a> leads to the following equation <a class="reference internal" href="bibliography.html#del87" id="id7"><span>[Del87]</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-diff-continuous-source-formulation">
<span class="eqno">(12)<a class="headerlink" href="#equation-diff-continuous-source-formulation" title="Permalink to this equation">¶</a></span>\[(u \cdot n)(x) = \frac{\sigma(x)}{2} + \iint_\Gamma \sigma(y) \, (\nabla_x G(x, y) \cdot n) \, \mathrm{dS}(y).\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> is the normal vector on the floating body surface <span class="math notranslate nohighlight">\(\Gamma\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dimensional analysis:</p>
<p><span class="math notranslate nohighlight">\(\Phi\)</span> is in m²·s¯¹.</p>
<p><span class="math notranslate nohighlight">\(\sigma\)</span> is in m·s¯¹.</p>
<p><span class="math notranslate nohighlight">\(G\)</span> is in m¯¹.</p>
</div>
</section>
</section>
<section id="expression-of-the-green-function">
<h2><a class="toc-backref" href="#id27" role="doc-backlink">Expression of the Green function</a><a class="headerlink" href="#expression-of-the-green-function" title="Permalink to this heading">¶</a></h2>
<section id="in-infinite-depth">
<h3><a class="toc-backref" href="#id28" role="doc-backlink">In infinite depth</a><a class="headerlink" href="#in-infinite-depth" title="Permalink to this heading">¶</a></h3>
<p>The integral problem above relates the potential <span class="math notranslate nohighlight">\(\Phi\)</span> to the normal velocity
<span class="math notranslate nohighlight">\(u \cdot n\)</span> via the Green function <span class="math notranslate nohighlight">\(G\)</span>. Let us know discuss the evaluation of this
function for an infinite water depth.
See also <a class="reference internal" href="bibliography.html#x18" id="id8"><span>[X18]</span></a>.</p>
<section id="green-function">
<h4><a class="toc-backref" href="#id29" role="doc-backlink">Green function</a><a class="headerlink" href="#green-function" title="Permalink to this heading">¶</a></h4>
<p>The infinite depth Green function takes the following form</p>
<div class="math notranslate nohighlight" id="equation-green-function-inf-depth">
<span class="eqno">(13)<a class="headerlink" href="#equation-green-function-inf-depth" title="Permalink to this equation">¶</a></span>\[G(\xi, x) = - \frac{1}{4 \pi} \left( \frac{1}{\|x - \xi\|} + k \mathcal{G}\left(k \sqrt{(x_1 - \xi_1)^2 + (x_2 - \xi_2)^2}, k (x_3 + \xi_3) \right) \right)\]</div>
<div class="proof proof-type-property" id="id17">

    <div class="proof-title">
        <span class="proof-type">Property 1</span>
        
    </div><div class="proof-content">
<p>The function <span class="math notranslate nohighlight">\(G\)</span> is symmetric in the sense of</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-4">
<span class="eqno">(14)<a class="headerlink" href="#equation-theory-manual-theory-4" title="Permalink to this equation">¶</a></span>\[\forall x, \xi, \quad G(x, \xi) = G(\xi, x).\]</div>
</div></div><p>The first term of <span class="math notranslate nohighlight">\(G\)</span> is the usual Green function for the 3D Laplace equation without our specific boundary conditions.
The <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> term is complex-valued and it is introduced to satisfy the boundary conditions <a class="reference internal" href="#equation-bc-fs">(5)</a>.</p>
<p>Intoducting the dimensionless variables <span class="math notranslate nohighlight">\(r = k \sqrt{(\xi_1 - x_1)^2 + (\xi_2 - x_2)^2}\)</span> and <span class="math notranslate nohighlight">\(z = k (x_3 + \xi_3)\)</span>, this term reads</p>
<div class="math notranslate nohighlight" id="equation-green-function-inf-depth-xie">
<span class="eqno">(15)<a class="headerlink" href="#equation-green-function-inf-depth-xie" title="Permalink to this equation">¶</a></span>\[\begin{split}\mathcal{G}(r, z) &amp; = \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \Re \left( \int^{\pi/2}_{-\pi/2}  J(\zeta(r, z, \theta)) \, \mathrm{d} \theta \right) \\
&amp; \qquad \qquad \qquad \qquad + 2 i \Re \left( \int^{\pi/2}_{-\pi/2} e^{\zeta (r, z, \theta)} \, \mathrm{d} \theta \right)\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-5">
<span class="eqno">(16)<a class="headerlink" href="#equation-theory-manual-theory-5" title="Permalink to this equation">¶</a></span>\[J(\zeta) = e^\zeta \left[ E_1(\zeta) + i \pi \right]\]</div>
<p>where <span class="math notranslate nohighlight">\(E_1\)</span> is the first exponential integral, defined as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-6">
<span class="eqno">(17)<a class="headerlink" href="#equation-theory-manual-theory-6" title="Permalink to this equation">¶</a></span>\[E_1(\zeta) = \int_\zeta^\infty \frac{e^{-t}}{t} dt,\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-def-zeta">
<span class="eqno">(18)<a class="headerlink" href="#equation-def-zeta" title="Permalink to this equation">¶</a></span>\[\zeta (r, z, \theta) = z + i r \cos \theta.\]</div>
<p>The first term of <a class="reference internal" href="#equation-green-function-inf-depth-xie">(15)</a> is actually a Rankine-type singularity similar to the first term of <a class="reference internal" href="#equation-green-function-inf-depth">(13)</a>, except that one of the point has been reflected through the free surface.</p>
</section>
<section id="variants-of-the-formulation">
<h4><a class="toc-backref" href="#id30" role="doc-backlink">Variants of the formulation</a><a class="headerlink" href="#variants-of-the-formulation" title="Permalink to this heading">¶</a></h4>
<div class="proof proof-type-lemma" id="id18">
<span id="integrate-one-over-zeta"></span>
    <div class="proof-title">
        <span class="proof-type">Lemma 2</span>
        
    </div><div class="proof-content">
<p>The following identity holds <a class="reference internal" href="bibliography.html#del89" id="id9"><span>[Del89]</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-int-1-over-zeta">
<span class="eqno">(19)<a class="headerlink" href="#equation-int-1-over-zeta" title="Permalink to this equation">¶</a></span>\[\Re \int^{\pi/2}_{-\pi/2} \frac{1}{\zeta(\theta)} \, \mathrm{d} \theta = - \frac{\pi}{\sqrt{r^2 + z^2}}.\]</div>
</div></div><p>The above lemma allows to retrieve the expression of the Green function found e.g. in <a class="reference internal" href="bibliography.html#bd15" id="id10"><span>[BD15]</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-green-function-inf-depth-del">
<span class="eqno">(20)<a class="headerlink" href="#equation-green-function-inf-depth-del" title="Permalink to this equation">¶</a></span>\[\begin{split}\mathcal{G}(r, z) &amp; = - \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \Re \left( \int^{\pi/2}_{-\pi/2} \left( J(\zeta(r, z, \theta)) - \frac{1}{\zeta(r, z, \theta)} \right) \, \mathrm{d} \theta \right) \\
&amp; \qquad \qquad \qquad \qquad + 2 i k \Re \left( \int^{\pi/2}_{-\pi/2} e^{\zeta (r, z, \theta)} \, \mathrm{d} \theta \right)\end{split}\]</div>
<p>(Note the minus sign in front of the first term.)</p>
<div class="proof proof-type-lemma" id="id19">

    <div class="proof-title">
        <span class="proof-type">Lemma 3</span>
        
    </div><div class="proof-content">
<p>The <a class="reference external" href="https://personal.math.ubc.ca/~cbm/aands/page_360.htm">zeroth order Bessel function of the first kind</a> <span class="math notranslate nohighlight">\(J_0\)</span> and <a class="reference external" href="https://personal.math.ubc.ca/~cbm/aands/page_496.htm">the Struve function</a> <span class="math notranslate nohighlight">\(H_0\)</span> are such that</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-7">
<span class="eqno">(21)<a class="headerlink" href="#equation-theory-manual-theory-7" title="Permalink to this equation">¶</a></span>\[\begin{split}J_0(r) &amp; = \frac{1}{\pi} \int_{-\pi/2}^{\pi/2} \cos(r\cos(\theta)) \, \mathrm{d} \theta \\
H_0(r) &amp; = \frac{1}{\pi} \int_{-\pi/2}^{\pi/2} \sin(r\cos(\theta)) \, \mathrm{d} \theta \\\end{split}\]</div>
<p>hence</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-8">
<span class="eqno">(22)<a class="headerlink" href="#equation-theory-manual-theory-8" title="Permalink to this equation">¶</a></span>\[\int_{-\pi/2}^{\pi/2} i e^{\zeta} \, \mathrm{d} \theta = \pi e^z \left(- H_0(r) + i J_0(r) \right)\]</div>
</div></div><p>The function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> can also be rewritten as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-9">
<span class="eqno">(23)<a class="headerlink" href="#equation-theory-manual-theory-9" title="Permalink to this equation">¶</a></span>\[\begin{split}\mathcal{G}(r, z) &amp; = \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \int^{\pi/2}_{-\pi/2} \Re \left( e^\zeta E_1(\zeta) \right) \, \mathrm{d} \theta + 2 \int^{\pi/2}_{-\pi/2} i e^{\zeta (r, z, \theta)} \, \mathrm{d} \theta \\
&amp; = \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \int^{\pi/2}_{-\pi/2} \Re \left( e^\zeta E_1(\zeta) \right) \, \mathrm{d} \theta + 2 \pi e^z \left( - H_0(r) + i J_0(r) \right)\end{split}\]</div>
<p>Noblesse <a class="reference internal" href="bibliography.html#n82" id="id11"><span>[N82]</span></a> splits the function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> into a near field term <span class="math notranslate nohighlight">\(N\)</span> and a wave field <span class="math notranslate nohighlight">\(W\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-10">
<span class="eqno">(24)<a class="headerlink" href="#equation-theory-manual-theory-10" title="Permalink to this equation">¶</a></span>\[\begin{split}N(r, z) &amp; = \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \int^{\pi/2}_{-\pi/2} \Re \left( e^\zeta E_1(\zeta)  \right) \, \mathrm{d} \theta  \\
W(r, z) &amp; = 2 \pi e^z \left( - H_0(r) + i J_0(r) \right)\end{split}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(E_1\)</span>, <span class="math notranslate nohighlight">\(J_0\)</span> and <span class="math notranslate nohighlight">\(H_0\)</span> are available for instance in the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html">Scipy library</a>.</p>
<div class="proof proof-type-lemma" id="id20">

    <div class="proof-title">
        <span class="proof-type">Lemma 4</span>
        
    </div><div class="proof-content">
<p>For any function <span class="math notranslate nohighlight">\(f\)</span>, the following two formulations of the integral are equivalent <a class="reference internal" href="bibliography.html#del89" id="id12"><span>[Del89]</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-11">
<span class="eqno">(25)<a class="headerlink" href="#equation-theory-manual-theory-11" title="Permalink to this equation">¶</a></span>\[\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} f \left(\zeta(\theta) \right) \mathrm{d} \theta =
\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} f \left(\tilde{\zeta}(\theta) \right) \mathrm{d} \theta\]</div>
<p>where <span class="math notranslate nohighlight">\(\zeta\)</span> is defined in <a class="reference internal" href="#equation-def-zeta">(18)</a> and <span class="math notranslate nohighlight">\(\tilde{\zeta}\)</span> is defined as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-12">
<span class="eqno">(26)<a class="headerlink" href="#equation-theory-manual-theory-12" title="Permalink to this equation">¶</a></span>\[\tilde{\zeta} (\theta) = k \left( x_3 + \xi_3 + i \left( (x_1 - \xi_1) \cos\theta + (x_2 - \xi_2) \sin\theta \right) \right).\]</div>
</div></div><div class="proof proof-type-proof">

    <div class="proof-title">
        <span class="proof-type">Proof </span>
        
    </div><div class="proof-content">
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-13">
\begin{align*}
(x_1 - \xi_1) \cos(\theta) + (x_2 - \xi_2) \sin(\theta) &amp; = \Re \left( \left( x_1 - \xi_1  + i (x_2 - \xi_2) \right) e^{-i \theta} \right) \\
             &amp; = \Re \left( r e^{i (\alpha - \theta)} \right) \\
             &amp; = r \cos \left( \alpha - \theta \right) \\
\end{align*}</div><p>where <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> are defined by</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-14">
\[
    r e^{i \alpha} = (x_1 - \xi_1)  + i (x_2 - \xi_2).
\]</div><p>Finally note that:</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-theory-manual-theory-15">
\[
    \int_{-\frac{\pi}{2}-\alpha}^{\frac{\pi}{2}-\alpha} f \left(\zeta(\theta) \right) \mathrm{d} \theta =
    \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} f \left(\zeta(\theta) \right) \mathrm{d} \theta
\]</div></div></blockquote>
</div></div></section>
<section id="gradient-of-the-green-function">
<h4><a class="toc-backref" href="#id31" role="doc-backlink">Gradient of the Green function</a><a class="headerlink" href="#gradient-of-the-green-function" title="Permalink to this heading">¶</a></h4>
<p>The gradient of the Green function can be written as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-16">
<span class="eqno">(30)<a class="headerlink" href="#equation-theory-manual-theory-16" title="Permalink to this equation">¶</a></span>\[\begin{split}\nabla_x G(\xi, x) = - \frac{1}{4 \pi} \left( - \frac{x - \xi}{\|x - \xi\|^3} + k
   \begin{pmatrix}
     \frac{\partial r}{\partial x_1} \frac{\partial \mathcal{G}}{\partial r} \\
     \frac{\partial r}{\partial x_2} \frac{\partial \mathcal{G}}{\partial r} \\
     \frac{\partial z}{\partial x_3} \frac{\partial \mathcal{G}}{\partial z}
   \end{pmatrix}
\right)\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-17">
<span class="eqno">(31)<a class="headerlink" href="#equation-theory-manual-theory-17" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial r}{\partial x_1} &amp; = k \frac{x_1 - \xi_1}{r} \\
\frac{\partial r}{\partial x_2} &amp; = k \frac{x_2 - \xi_2}{r} \\
\frac{\partial z}{\partial x_3} &amp; = k\end{split}\]</div>
<p>and, using the identity <span class="math notranslate nohighlight">\(J'(\zeta) = J(\zeta) - 1/\zeta\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-18">
<span class="eqno">(32)<a class="headerlink" href="#equation-theory-manual-theory-18" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial \mathcal{G}}{\partial r} = &amp; - \frac{r}{(r^2 + z^2)^{3/2}} + \frac{2}{\pi} \Re \left( \int_{-\pi/2}^{\pi/2} i \cos(\theta) \left( J(\zeta) - \frac{1}{\zeta} \right) \, \mathrm{d}\theta \right) \\
&amp; \qquad \qquad \qquad \qquad + 2 i \Re \left( \int^{\pi/2}_{-\pi/2} i \cos(\theta) e^{\zeta} \, \mathrm{d} \theta \right)\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-19">
<span class="eqno">(33)<a class="headerlink" href="#equation-theory-manual-theory-19" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial \mathcal{G}}{\partial z} = &amp; - \frac{z}{(r^2 + z^2)^{3/2}} + \frac{2}{\pi} \Re \left( \int_{-\pi/2}^{\pi/2} \left( J(\zeta) - \frac{1}{\zeta} \right) \, \mathrm{d}\theta \right) \\
 &amp; \qquad \qquad \qquad \qquad + 2 i \Re \left( \int^{\pi/2}_{-\pi/2} i \cos(\theta) e^{\zeta } \, \mathrm{d} \theta \right) \\\end{split}\]</div>
<p>that is, using <a class="reference internal" href="#integrate-one-over-zeta"><span class="std std-numref">Lemma 2</span></a></p>
<div class="math notranslate nohighlight" id="equation-green-function-inf-depth-dgdz">
<span class="eqno">(34)<a class="headerlink" href="#equation-green-function-inf-depth-dgdz" title="Permalink to this equation">¶</a></span>\[\frac{\partial \mathcal{G}}{\partial z} = \mathcal{G}(r, z) + \frac{1}{\sqrt{r^2 + z^2}} - \frac{z}{(r^2 + z^2)^{3/2}}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The derivative of <span class="math notranslate nohighlight">\(G\)</span> with respect to <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are antisymmetric in the sense of</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-20">
 \[
 \frac{\partial G}{\partial x_1} (\xi, x) = - \frac{\partial G}{\partial x_1}(x, \xi).
 \]</div><p>Its derivative with respect to <span class="math notranslate nohighlight">\(x_3\)</span> can be decomposed into an antisymmetric term and a symmetric term.</p>
</div>
</section>
<section id="higher-order-derivative">
<h4><a class="toc-backref" href="#id32" role="doc-backlink">Higher order derivative</a><a class="headerlink" href="#higher-order-derivative" title="Permalink to this heading">¶</a></h4>
<p>From <a class="reference internal" href="#equation-green-function-inf-depth-dgdz">(34)</a>, one has</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-21">
<span class="eqno">(36)<a class="headerlink" href="#equation-theory-manual-theory-21" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial \mathcal{G}}{\partial z} &amp;= \mathcal{G}(r, z) + \left( 1 + \frac{\partial}{\partial z} \right) \frac{1}{\sqrt{r^2 + z^2}} \\
\frac{\partial^2 \mathcal{G}}{\partial z \partial r} &amp;= \frac{\partial \mathcal{G}}{\partial r} + \left( \frac{\partial}{\partial r} + \frac{\partial^2}{\partial z \partial r} \right) \frac{1}{\sqrt{r^2 + z^2}}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-22">
<span class="eqno">(37)<a class="headerlink" href="#equation-theory-manual-theory-22" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial^2 \mathcal{G}}{\partial z^2} &amp;= \mathcal{G}(r, z) + \left( 1 + 2 \frac{\partial}{\partial z} + \frac{\partial^2}{\partial z^2} \right)\frac{1}{\sqrt{r^2 + z^2}} \\
                                            &amp;= \mathcal{G}(r, z) + \frac{1}{\sqrt{r^2 + z^2}} - 2 \frac{z}{(r^2 + z^2)^{3/2}} - \frac{r^2 - 2 z^2}{(r^2 + z^2)^{5/2}}\end{split}\]</div>
<p>Since the Green function is solution of the Laplace equation, it follows that</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-23">
<span class="eqno">(38)<a class="headerlink" href="#equation-theory-manual-theory-23" title="Permalink to this equation">¶</a></span>\[\frac{\partial^2 \mathcal{G}}{\partial r^2} + \frac{1}{r} \frac{\partial \mathcal{G}}{\partial r} + \frac{\partial^2 \mathcal{G}}{\partial z^2} = 0\]</div>
<p>then</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-24">
<span class="eqno">(39)<a class="headerlink" href="#equation-theory-manual-theory-24" title="Permalink to this equation">¶</a></span>\[\begin{split}\frac{\partial^2 \mathcal{G}}{\partial r^2} = - \frac{1}{r} \frac{\partial \mathcal{G}}{\partial r} - \mathcal{G} - \left( 1 + 2 \frac{\partial}{\partial z} + \frac{\partial^2}{\partial z^2} \right)\frac{1}{\sqrt{r^2 + z^2}} \\\end{split}\]</div>
<p>All higher order derivative can be expressed with the help of <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial \mathcal{G}}{\partial r}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The same derivation is done in e.g. <a class="reference internal" href="bibliography.html#n20" id="id13"><span>[N20]</span></a> using instead the function <span class="math notranslate nohighlight">\(F = \mathcal{G} - \frac{1}{\sqrt{r^2 + z^2}}\)</span> for which the expressions are slightly simpler.</p>
</div>
</section>
<section id="delhommeau-s-method-for-computation">
<h4><a class="toc-backref" href="#id33" role="doc-backlink">Delhommeau’s method for computation</a><a class="headerlink" href="#delhommeau-s-method-for-computation" title="Permalink to this heading">¶</a></h4>
<p>Delhommeau’s method is based on expression <a class="reference internal" href="#equation-green-function-inf-depth-del">(20)</a> of the Green function.
This expression of the Green function and its derivative require the evaluation of the following real-valued integrals:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-25">
<span class="eqno">(40)<a class="headerlink" href="#equation-theory-manual-theory-25" title="Permalink to this equation">¶</a></span>\[\begin{split}D_1(r, z) &amp; = \Re \left( \int^{\pi/2}_{-\pi/2} - i \cos(\theta) \left( J(\zeta) - \frac{1}{\zeta} \right) \, \mathrm{d} \theta \right) \\
D_2(r, z) &amp; = \Re \left( \int^{\pi/2}_{-\pi/2} - i \cos(\theta) e^{\zeta} \, \mathrm{d} \theta \right) \\
Z_1(r, z) &amp; = \Re \left( \int^{\pi/2}_{-\pi/2} \left( J(\zeta) - \frac{1}{\zeta} \right) \, \mathrm{d} \theta \right) \\
Z_2(r, z) &amp; = \Re \left( \int^{\pi/2}_{-\pi/2} e^{\zeta} \, \mathrm{d} \theta \right)\end{split}\]</div>
<p>To limit the computational cost of the evaluation of these integrals, they are precomputed for selected values of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(z\)</span> and stored in a table.
When evaluating the Green function, the values of the integrals are retrieved by interpolating the values in the tables.</p>
<p>For large values of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(z\)</span>, these integrals are asymptotically approximated by the following expressions:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-26">
<span class="eqno">(41)<a class="headerlink" href="#equation-theory-manual-theory-26" title="Permalink to this equation">¶</a></span>\[\begin{split}D_1(r, z) &amp; \simeq \pi e^z \sqrt{\frac{2\pi}{r}} \left(\cos(r - \pi/4) - \frac{1}{2r} \sin(r-\pi/4) \right) - \pi \frac{r}{(r^2 + z^2)^{3/2}} \\
D_2(r, z) &amp; \simeq e^z \sqrt{\frac{2\pi}{r}} \left( \sin(r - \pi/4) + \frac{1}{2r} \cos(r - \pi/4) \right) \\
Z_1(r, z) &amp; \simeq - \pi e^z \sqrt{\frac{2\pi}{r}} \sin(r - \pi/4) + \pi \frac{z}{(r^2 + z^2)^{3/2}} \\
Z_2(r, z) &amp; \simeq e^z \sqrt{\frac{2\pi}{r}} \cos(r - \pi/4)\end{split}\]</div>
<p>Incorporating these asymptotic approximation in the expression of the Green function, one gets:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-27">
<span class="eqno">(42)<a class="headerlink" href="#equation-theory-manual-theory-27" title="Permalink to this equation">¶</a></span>\[\begin{split}\mathcal{G}(r, z) \simeq &amp; -\frac{1}{\sqrt{r^2 + z^2}} - 2 k e^z \sqrt{\frac{2\pi}{r}} \left(\sin(r - \pi/4) - i\cos(r - \pi/4)\right) \\
&amp; \qquad\qquad\qquad\qquad + 2 k \frac{z}{(r^2 + z^2)^{3/2}}\end{split}\]</div>
</section>
<section id="xie-s-variant">
<h4><a class="toc-backref" href="#id34" role="doc-backlink">Xie’s variant</a><a class="headerlink" href="#xie-s-variant" title="Permalink to this heading">¶</a></h4>
<p>A slight variant is presented in <a class="reference internal" href="bibliography.html#x18" id="id14"><span>[X18]</span></a>. The authors noticed that the
interpolation of the integral <span class="math notranslate nohighlight">\(Z_1\)</span> can be inaccurate due to the
singularity <span class="math notranslate nohighlight">\(\frac{1}{\zeta}\)</span>.
Hence, they proposed to use <a class="reference internal" href="#equation-green-function-inf-depth-xie">(15)</a> and to tabulate the integral</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-28">
<span class="eqno">(43)<a class="headerlink" href="#equation-theory-manual-theory-28" title="Permalink to this equation">¶</a></span>\[\widetilde{Z_1}(r, z) = \Re \left( \int^{\pi/2}_{-\pi/2} J(\zeta) \, \mathrm{d} \theta \right)\]</div>
<p>By using <a class="reference internal" href="#integrate-one-over-zeta"><span class="std std-numref">Lemma 2</span></a>, one has</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-29">
<span class="eqno">(44)<a class="headerlink" href="#equation-theory-manual-theory-29" title="Permalink to this equation">¶</a></span>\[Z_1 = \widetilde{Z_1} - \frac{\pi}{\sqrt{r^2 + z^2}}\]</div>
<p>Both the original Delhommeau’s method and Xie’s variant are implemented in Capytaine.</p>
</section>
</section>
<section id="in-finite-depth">
<h3><a class="toc-backref" href="#id35" role="doc-backlink">In finite depth</a><a class="headerlink" href="#in-finite-depth" title="Permalink to this heading">¶</a></h3>
<section id="id15">
<h4><a class="toc-backref" href="#id36" role="doc-backlink">Green function</a><a class="headerlink" href="#id15" title="Permalink to this heading">¶</a></h4>
<p>TODO</p>
</section>
<section id="id16">
<h4><a class="toc-backref" href="#id37" role="doc-backlink">Gradient of the Green function</a><a class="headerlink" href="#id16" title="Permalink to this heading">¶</a></h4>
<p>TODO</p>
</section>
</section>
<section id="symmetries">
<h3><a class="toc-backref" href="#id38" role="doc-backlink">Symmetries</a><a class="headerlink" href="#symmetries" title="Permalink to this heading">¶</a></h3>
<p>The first term of <a class="reference internal" href="#equation-green-function-inf-depth">(13)</a> is invariant under all rotations and translations, whereas the other terms are invariant under isometric transformations that don’t change the vertical coordinate (reflection across a vertical plane, rotation around a vertical axis, translation following an horizontal vector).</p>
</section>
</section>
<section id="discretization">
<h2><a class="toc-backref" href="#id39" role="doc-backlink">Discretization</a><a class="headerlink" href="#discretization" title="Permalink to this heading">¶</a></h2>
<p>The equations <a class="reference internal" href="#equation-continuous-source-formulation">(11)</a> and <a class="reference internal" href="#equation-diff-continuous-source-formulation">(12)</a> can be discretized using a collocation method.
Considering a mesh of the surface of the floating body <span class="math notranslate nohighlight">\(\Gamma = \cup_i \Gamma_i\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-30">
<span class="eqno">(45)<a class="headerlink" href="#equation-theory-manual-theory-30" title="Permalink to this equation">¶</a></span>\[\begin{split}\Phi_i   &amp; = \Phi(x_i), \\
\sigma_i &amp; = \sigma(x_i), \\
u_i      &amp; = (u \cdot n)(x_i) \\
S_{ij}   &amp; = \iint_{\Gamma_j} G(x_i, y) \mathrm{dS}(y), \\
V_{ij}   &amp; = \iint_{\Gamma_j} \nabla_{x_i} G(x_i, y) \cdot n \, \mathrm{dS}(y),\end{split}\]</div>
<p>where for all <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(x_i\)</span> is the center of the face <span class="math notranslate nohighlight">\(\Gamma_i\)</span>.
Each element of the matrices <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(V\)</span> can be seen as the interaction between two faces of the mesh.</p>
<p>The matrices <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(V\)</span> relates the vectors <span class="math notranslate nohighlight">\(\Phi\)</span>, <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> through the following approximations of <a class="reference internal" href="#equation-continuous-source-formulation">(11)</a> and <a class="reference internal" href="#equation-diff-continuous-source-formulation">(12)</a>:</p>
<div class="math notranslate nohighlight" id="equation-discrete-bem-problem">
<span class="eqno">(46)<a class="headerlink" href="#equation-discrete-bem-problem" title="Permalink to this equation">¶</a></span>\[\Phi = S \sigma, \qquad u = \left( \frac{\mathbb{I}}{2} + V \right) \sigma.\]</div>
<p>The resolution of the discrete problem with Nemoh consists of two main steps:</p>
<ol class="arabic simple">
<li><p>The evaluation of the coefficients of the complex-valued matrices <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(V\)</span></p></li>
<li><p>The resolution of the complex-valued linear problem <span class="math notranslate nohighlight">\(K \sigma = \left( \frac{\mathbb{I}}{2} + V \right) \sigma = u\)</span>.</p></li>
</ol>
<p>Once <span class="math notranslate nohighlight">\(\sigma\)</span> has been computed, <span class="math notranslate nohighlight">\(\Phi\)</span> can be easily deduced.
Then other magnitudes such as the Froude-Krylov forces or the added mass can be derived.</p>
<figure class="align-default" id="id21">
<div class="mermaid">
            flowchart TD;
    h[Water depth] --&gt; gf(Assembling matrices);
    ω[Wave frequency ω] --&gt; gf(Assembling matrices);
    m[Mesh] --&gt; gf;
    gf -- K matrix --&gt; ls(Linear solver);
    un[Normal velocity on hull] --&gt; ls;
    gf -- S matrix --&gt; mvp(Matrix vector product);
    ls -- sources distribution σ --&gt; mvp;
    mvp -- potential distribution Φ --&gt; int(&quot;Integrate on mesh&quot;);
    m --&gt; int;
    int --&gt; f[&quot;Hydrodynamic forces\n(aka added mass and radiation damping)&quot;]

    classDef input fill:#FFAAAA,color:#550000,stroke:#113939
    classDef step fill:#88BBBB,color:#003333,stroke:#226666
    classDef output fill:#FFE3AA,color:#553900,stroke:#AA8439
    class ω,m,un,h input
    class gf,ls,mvp,int step
    class f output
        </div><figcaption>
<p><span class="caption-number">Fig. 1 </span><span class="caption-text">A simplified flowchart of the internals of Capytaine solver</span><a class="headerlink" href="#id21" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="post-processing">
<h2><a class="toc-backref" href="#id40" role="doc-backlink">Post-processing</a><a class="headerlink" href="#post-processing" title="Permalink to this heading">¶</a></h2>
<section id="forces-on-body-surfaces">
<h3><a class="toc-backref" href="#id41" role="doc-backlink">Forces on body surfaces</a><a class="headerlink" href="#forces-on-body-surfaces" title="Permalink to this heading">¶</a></h3>
<p>Forces acting on body surfaces are computed by integration of the pressure field. They can be decomposed into three contributions:</p>
<ol class="arabic simple">
<li><p>The Froude-Krylov forces <span class="math notranslate nohighlight">\(F_{FK, i}\)</span>, from the integration of the incident wave field pressure (incoming plane waves); <span class="math notranslate nohighlight">\(i\)</span> denotes the i-th degree of freedom</p></li>
<li><p>The diffraction forces <span class="math notranslate nohighlight">\(F_{D, i}\)</span>, from the integration of the diffracted wave field (all bodies held fixed)</p></li>
<li><p>The radiation forces <span class="math notranslate nohighlight">\(F_{R, ij}\)</span>, from the result of the radiation problem with radiating degree of freedom <span class="math notranslate nohighlight">\(j\)</span> and influenced degree of freedom <span class="math notranslate nohighlight">\(i\)</span></p></li>
</ol>
</section>
<section id="dynamic-coupling-and-impedance">
<h3><a class="toc-backref" href="#id42" role="doc-backlink">Dynamic coupling and impedance</a><a class="headerlink" href="#dynamic-coupling-and-impedance" title="Permalink to this heading">¶</a></h3>
<p>Consider a body or a system of bodies. The general linear equation of motion can be expressed in time domain as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-31">
<span class="eqno">(47)<a class="headerlink" href="#equation-theory-manual-theory-31" title="Permalink to this equation">¶</a></span>\[M_{ij} \ddot{x}_j + C_{ij} \dot{x}_j + K_{ij} x_j = F_i,\]</div>
<p>and in frequency domain, with the assumed time dependence <span class="math notranslate nohighlight">\(x(t) = \mathrm{Re} \left( X e^{-j \omega t} \right)\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-32">
<span class="eqno">(48)<a class="headerlink" href="#equation-theory-manual-theory-32" title="Permalink to this equation">¶</a></span>\[\left[-\omega^2M_{ij} - j \omega C_{ij} + K_{ij}\right] X_j = F_i,\]</div>
<p>where <span class="math notranslate nohighlight">\(M_{ij}\)</span> is the inertia matrix, accounting for the mass distribution, <span class="math notranslate nohighlight">\(C_{ij}\)</span> is the mechanical damping matrix, <span class="math notranslate nohighlight">\(K_{ij}\)</span> is the stiffness matrix which comprises mechanical and hydrostatic effects, and <span class="math notranslate nohighlight">\(F_i\)</span> are generic external forces.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The hydrostatic contribution to matrix <span class="math notranslate nohighlight">\(K_{ij}\)</span> accounts for a variation of hydrostatic force in direction <span class="math notranslate nohighlight">\(i\)</span> due to a unit motion in direction <span class="math notranslate nohighlight">\(j\)</span>. It is a geometric property of the body.</p>
</div>
<p>Forces <span class="math notranslate nohighlight">\(F_i\)</span> can be decomposed as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-33">
<span class="eqno">(49)<a class="headerlink" href="#equation-theory-manual-theory-33" title="Permalink to this equation">¶</a></span>\[F_i = F_{FK, i} + F_{D, i} + F_{R, ij}\]</div>
<p>and <span class="math notranslate nohighlight">\(F_{R, ij}\)</span> can be further rewritten as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-34">
<span class="eqno">(50)<a class="headerlink" href="#equation-theory-manual-theory-34" title="Permalink to this equation">¶</a></span>\[F_{R, ij} = \left[\omega^2 A_{ij} + j\omega B_{ij}\right] X_j\]</div>
<p>where <span class="math notranslate nohighlight">\(A_{ij}\)</span> is the added mass matrix and <span class="math notranslate nohighlight">\(B_{ij}\)</span> is the radiation damping matrix; these properties are thus obtained from the real and imaginary parts of the radiation force. The full system becomes</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-35">
<span class="eqno">(51)<a class="headerlink" href="#equation-theory-manual-theory-35" title="Permalink to this equation">¶</a></span>\[\left[-\omega^2 (M_{ij} + A_{ij}) - j \omega (C_{ij} + B_{ij}) + K_{ij}\right] X_j = F_{FK, i} + F_{D, i}\]</div>
<p>that is</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-36">
<span class="eqno">(52)<a class="headerlink" href="#equation-theory-manual-theory-36" title="Permalink to this equation">¶</a></span>\[H X = F_{ex}\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> denotes the following transfer function matrix</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-37">
<span class="eqno">(53)<a class="headerlink" href="#equation-theory-manual-theory-37" title="Permalink to this equation">¶</a></span>\[H_{ij} = \left[-\omega^2 (M_{ij} + A_{ij}) - j \omega (C_{ij} + B_{ij}) + K_{ij}\right]\]</div>
<p>and <span class="math notranslate nohighlight">\(F_{ex}\)</span> denotes the excitation force.</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-38">
<span class="eqno">(54)<a class="headerlink" href="#equation-theory-manual-theory-38" title="Permalink to this equation">¶</a></span>\[F_{ex, i} = F_{FK, i} + F_{D, i}.\]</div>
<p>The oscillation amplitude is obtained by solving the complex-valued linear system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrices <span class="math notranslate nohighlight">\(A_{ij}\)</span> and <span class="math notranslate nohighlight">\(B_{ij}\)</span> depend on <span class="math notranslate nohighlight">\(\omega\)</span>, and so does <span class="math notranslate nohighlight">\(H_{ij}\)</span> and <span class="math notranslate nohighlight">\(X_j\)</span>.</p>
</div>
</section>
<section id="free-surface-elevation">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">Free surface elevation</a><a class="headerlink" href="#free-surface-elevation" title="Permalink to this heading">¶</a></h3>
<p>The potential at the reference surface <span class="math notranslate nohighlight">\(z = 0\)</span> can be connected to the free surface elevation by the dynamic condition</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-39">
<span class="eqno">(55)<a class="headerlink" href="#equation-theory-manual-theory-39" title="Permalink to this equation">¶</a></span>\[\dfrac{\partial \phi}{\partial t} = - g \eta\]</div>
<p>which, in frequency domain, is</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-40">
<span class="eqno">(56)<a class="headerlink" href="#equation-theory-manual-theory-40" title="Permalink to this equation">¶</a></span>\[\eta = \dfrac{j \omega}{g} \Phi\]</div>
<p>For a fully coupled problem (bodies free to oscillate, i.e. diffraction and radiation combined), the free surface elevation can be computed as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-41">
<span class="eqno">(57)<a class="headerlink" href="#equation-theory-manual-theory-41" title="Permalink to this equation">¶</a></span>\[\eta = \eta_{\text{incident}} + \eta_{\text{diffracted}} -j \omega \sum_i \eta_{\text{radiated}, i}   X_i\]</div>
<p>where factor <span class="math notranslate nohighlight">\(-j \omega\)</span> transforms <span class="math notranslate nohighlight">\(\eta_{\text{radiated}, i}\)</span> from the radiated wave field corresponding to unit oscillation velocity to the field corresponding to unit oscillation amplitude.</p>
</section>
<section id="far-field-coefficients">
<h3><a class="toc-backref" href="#id44" role="doc-backlink">Far-field coefficients</a><a class="headerlink" href="#far-field-coefficients" title="Permalink to this heading">¶</a></h3>
<p>TODO</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/index.html">User manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_manual/index.html">Developer manual</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Theory manual</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Theory manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Theory manual</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Theory manual</a></li>
      <li>Next: <a href="bibliography.html" title="next chapter">Bibliography</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../_sources/theory_manual/theory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Matthieu Ancellin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.0.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="../_sources/theory_manual/theory.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>