<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>capytaine.green_functions.delhommeau module &#8212; capytaine 2.1.dev documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../_static/proof.css?v=e9a64e30" />
    <script src="../../_static/documentation_options.js?v=5897b821"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/proof.js?v=41e9dd12"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="capytaine.bem.airy_waves module" href="capytaine.bem.airy_waves.html" />
    <link rel="prev" title="capytaine.green_functions.abstract_green_function module" href="capytaine.green_functions.abstract_green_function.html" />
    <script defer data-domain="ancell.in/capytaine" src="https://plausible.io/js/script.js"></script>
    <jinja2.runtime.BlockReference object at 0x7f39fae0c250>

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="module-capytaine.green_functions.delhommeau">
<span id="capytaine-green-functions-delhommeau-module"></span><h1>capytaine.green_functions.delhommeau module<a class="headerlink" href="#module-capytaine.green_functions.delhommeau" title="Link to this heading">¶</a></h1>
<p>Variants of Delhommeau’s method for the computation of the Green function.</p>
<dl class="py class">
<dt class="sig sig-object py" id="capytaine.green_functions.delhommeau.Delhommeau">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">capytaine.green_functions.delhommeau.</span></span><span class="sig-name descname"><span class="pre">Delhommeau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabulation_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabulation_nz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabulation_nb_integration_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">251</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_depth_prony_decomposition_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fortran'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floating_point_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float64'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/capytaine/green_functions/delhommeau.html#Delhommeau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#capytaine.green_functions.delhommeau.Delhommeau" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="capytaine.green_functions.abstract_green_function.html#capytaine.green_functions.abstract_green_function.AbstractGreenFunction" title="capytaine.green_functions.abstract_green_function.AbstractGreenFunction"><code class="xref py py-class docutils literal notranslate"><span class="pre">AbstractGreenFunction</span></code></a></p>
<p>The Green function as implemented in Aquadyn and Nemoh.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tabulation_nr</strong> (<em>int, optional</em>) – Number of tabulation points for horizontal distance.
If 0 is given, the no tabulation is used.
Default: 328, as in Nemoh.</p></li>
<li><p><strong>tabulation_nz</strong> (<em>int, optional</em>) – Number of tabulation points for vertical distance.
If 0 is given, the no tabulation is used.
Default: 46, as in Nemoh.</p></li>
<li><p><strong>tabulation_nb_integration_points</strong> (<em>int, optional</em>) – Number of points for the numerical integration w.r.t. <span class="math notranslate nohighlight">\(theta\)</span> of Delhommeau’s integrals
Default: 251, as in Nemoh.</p></li>
<li><p><strong>finite_depth_prony_decomposition_method</strong> (<em>string, optional</em>) – The implementation of the Prony decomposition used to compute the finite water_depth Green function.
Accepted values: <code class="code docutils literal notranslate"><span class="pre">'fortran'</span></code> for Nemoh’s implementation (by default), <code class="code docutils literal notranslate"><span class="pre">'python'</span></code> for an experimental Python implementation.
See <a class="reference internal" href="#capytaine.green_functions.delhommeau.Delhommeau.find_best_exponential_decomposition" title="capytaine.green_functions.delhommeau.Delhommeau.find_best_exponential_decomposition"><code class="xref py py-func docutils literal notranslate"><span class="pre">find_best_exponential_decomposition()</span></code></a>.</p></li>
<li><p><strong>floating_point_precision</strong> (<em>string, optional</em>) – Either <code class="code docutils literal notranslate"><span class="pre">'float32'</span></code> for single precision computations or <code class="code docutils literal notranslate"><span class="pre">'float64'</span></code> for double precision computations.
Default: <code class="code docutils literal notranslate"><span class="pre">'float64'</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Variables<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>tabulated_r_range</strong> (<em>numpy.array</em><em> of </em><em>shape</em><em> (</em><em>tabulation_nr</em><em>,</em><em>) </em><em>and type floating_point_precision</em>) – </p></li>
<li><p><strong>tabulated_z_range</strong> (<em>numpy.array</em><em> of </em><em>shape</em><em> (</em><em>tabulation_nz</em><em>,</em><em>) </em><em>and type floating_point_precision</em>) – Coordinates of the tabulation points.</p></li>
<li><p><strong>tabulated_integrals</strong> (<em>numpy.array</em><em> of </em><em>shape</em><em> (</em><em>tabulation_nr</em><em>, </em><em>tabulation_nz</em><em>, </em><em>2</em><em>, </em><em>2</em><em>) </em><em>and type floating_point_precision</em>) – Tabulated Delhommeau integrals.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="capytaine.green_functions.delhommeau.Delhommeau.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mesh1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mesh2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">free_surface</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">water_depth</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">inf</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">wavenumber</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">early_dot_product</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/capytaine/green_functions/delhommeau.html#Delhommeau.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#capytaine.green_functions.delhommeau.Delhommeau.evaluate" title="Link to this definition">¶</a></dt>
<dd><p>The main method of the class, called by the engine to assemble the influence matrices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mesh1</strong> (<em>Mesh or CollectionOfMeshes or list of points</em>) – mesh of the receiving body (where the potential is measured)
if only S is wanted or early_dot_product is False, then only a list of points as an array of shape (n, 3) can be passed.</p></li>
<li><p><strong>mesh2</strong> (<em>Mesh or CollectionOfMeshes</em>) – mesh of the source body (over which the source distribution is integrated)</p></li>
<li><p><strong>free_surface</strong> (<em>float, optional</em>) – position of the free surface (default: <span class="math notranslate nohighlight">\(z = 0\)</span>)</p></li>
<li><p><strong>water_depth</strong> (<em>float, optional</em>) – constant depth of water (default: <span class="math notranslate nohighlight">\(+\infty\)</span>)</p></li>
<li><p><strong>wavenumber</strong> (<em>float, optional</em>) – wavenumber (default: 1.0)</p></li>
<li><p><strong>early_dot_product</strong> (<em>boolean, optional</em>) – if False, return K as a (n, m, 3) array storing ∫∇G
if True, return K as a (n, m) array storing ∫∇G·n</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the matrices <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(K\)</span></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>tuple of numpy arrays</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="capytaine.green_functions.delhommeau.Delhommeau.find_best_exponential_decomposition">
<span class="sig-name descname"><span class="pre">find_best_exponential_decomposition</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dimensionless_omega</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dimensionless_wavenumber</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/capytaine/green_functions/delhommeau.html#Delhommeau.find_best_exponential_decomposition"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#capytaine.green_functions.delhommeau.Delhommeau.find_best_exponential_decomposition" title="Link to this definition">¶</a></dt>
<dd><p>Compute the decomposition of a part of the finite water_depth Green function as a sum of exponential functions.</p>
<p>Two implementations are available: the legacy Fortran implementation from Nemoh and a newer one written in Python.
For some still unexplained reasons, the two implementations do not always give the exact same result.
Until the problem is better understood, the Fortran implementation is the default one, to ensure consistency with Nemoh.
The Fortran version is also significantly faster…</p>
<p>Results are cached.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dimensionless_omega</strong> (<em>float</em>) – dimensionless angular frequency: <span class="math notranslate nohighlight">\(kh \tanh (kh) = \omega^2 h/g\)</span></p></li>
<li><p><strong>dimensionless_wavenumber</strong> (<em>float</em>) – dimensionless wavenumber: <span class="math notranslate nohighlight">\(kh\)</span></p></li>
<li><p><strong>method</strong> (<em>string, optional</em>) – the implementation that should be used to compute the Prony decomposition</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>the amplitude and growth rates of the exponentials</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[np.ndarray, np.ndarray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="capytaine.green_functions.delhommeau.Delhommeau.fortran_core_basename">
<span class="sig-name descname"><span class="pre">fortran_core_basename</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Delhommeau'</span></em><a class="headerlink" href="#capytaine.green_functions.delhommeau.Delhommeau.fortran_core_basename" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="capytaine.green_functions.delhommeau.XieDelhommeau">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">capytaine.green_functions.delhommeau.</span></span><span class="sig-name descname"><span class="pre">XieDelhommeau</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabulation_nr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">400</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabulation_nz</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">80</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tabulation_nb_integration_points</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">251</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">finite_depth_prony_decomposition_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'fortran'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">floating_point_precision</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'float64'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../_modules/capytaine/green_functions/delhommeau.html#XieDelhommeau"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#capytaine.green_functions.delhommeau.XieDelhommeau" title="Link to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#capytaine.green_functions.delhommeau.Delhommeau" title="capytaine.green_functions.delhommeau.Delhommeau"><code class="xref py py-class docutils literal notranslate"><span class="pre">Delhommeau</span></code></a></p>
<p>Variant of Nemoh’s Green function, more accurate near the free surface.</p>
<p>Same arguments and methods as <a class="reference internal" href="#capytaine.green_functions.delhommeau.Delhommeau" title="capytaine.green_functions.delhommeau.Delhommeau"><code class="xref py py-class docutils literal notranslate"><span class="pre">Delhommeau</span></code></a>.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="capytaine.green_functions.delhommeau.XieDelhommeau.fortran_core_basename">
<span class="sig-name descname"><span class="pre">fortran_core_basename</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'XieDelhommeau'</span></em><a class="headerlink" href="#capytaine.green_functions.delhommeau.XieDelhommeau.fortran_core_basename" title="Link to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../features.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../user_manual/index.html">User manual</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Developer manual</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../installation.html">Installation for developers</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../overview.html">Overview of the modules</a></li>
<li class="toctree-l2"><a class="reference internal" href="modules.html">API documentation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../theory_manual/index.html">Theory manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../changelog.html">Changelog</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../../index.html">Documentation overview</a><ul>
  <li><a href="../index.html">Developer manual</a><ul>
  <li><a href="../overview.html">Overview of the modules</a><ul>
      <li>Previous: <a href="capytaine.green_functions.abstract_green_function.html" title="previous chapter">capytaine.green_functions.abstract_green_function module</a></li>
      <li>Next: <a href="capytaine.bem.airy_waves.html" title="next chapter">capytaine.bem.airy_waves module</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="../../_sources/developer_manual/api/capytaine.green_functions.delhommeau.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2022, Matthieu Ancellin.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.6</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../../_sources/developer_manual/api/capytaine.green_functions.delhommeau.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>