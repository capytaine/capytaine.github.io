<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Theory manual &#8212; capytaine 2.3.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/basic.css?v=b08954a9" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=27fed22d" />
    <link rel="stylesheet" type="text/css" href="../_static/proof.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <script src="../_static/documentation_options.js?v=67b02a41"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs"></script>
    <script type="module" src="https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs"></script>
    <script type="module">import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";import elkLayouts from "https://cdn.jsdelivr.net/npm/@mermaid-js/layout-elk@0.1.4/dist/mermaid-layout-elk.esm.min.mjs";mermaid.registerLayoutLoaders(elkLayouts);mermaid.initialize({startOnLoad:false});</script>
    <script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script>
    <script type="module">
import mermaid from "https://cdn.jsdelivr.net/npm/mermaid@11.2.0/dist/mermaid.esm.min.mjs";
window.addEventListener("load", () => mermaid.run());
</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Bibliography" href="bibliography.html" />
    <link rel="prev" title="Theory manual" href="index.html" />
    <script defer data-domain="capytaine.github.io" src="https://plausible.io/js/script.js"></script>
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
    
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  

  
  


  </head><body>
  

    <div class="document">
<div id="new-doc-warning-banner" style="width:100%; background-color:#ADD8E6; text-align: center;">This page is part of the documentation of the development version 2.3.1 of Capytaine.<br><a href="https://capytaine.github.io/stable/">Latest stable version is available here.</a></div>
    
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="theory-manual">
<h1><a class="toc-backref" href="#id21" role="doc-backlink">Theory manual</a><a class="headerlink" href="#theory-manual" title="Link to this heading">¶</a></h1>
<p>This document presents several aspects of the theoretical background for Nemoh and Capytaine.
We refer also to <a class="reference internal" href="bibliography.html#del87" id="id1"><span>[Del87]</span></a> <a class="reference internal" href="bibliography.html#del89" id="id2"><span>[Del89]</span></a> <a class="reference internal" href="bibliography.html#del93" id="id3"><span>[Del93]</span></a> <a class="reference internal" href="bibliography.html#bd15" id="id4"><span>[BD15]</span></a> and <a class="reference internal" href="bibliography.html#ad18" id="id5"><span>[AD18]</span></a>.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This document is a work in progress. It is incomplete and might
contain errors.</p>
</div>
<nav class="contents" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#theory-manual" id="id21">Theory manual</a></p>
<ul>
<li><p><a class="reference internal" href="#linear-boundary-value-problem" id="id22">Linear boundary value problem</a></p>
<ul>
<li><p><a class="reference internal" href="#hypotheses" id="id23">Hypotheses</a></p></li>
<li><p><a class="reference internal" href="#mathematical-problem" id="id24">Mathematical problem</a></p></li>
<li><p><a class="reference internal" href="#integral-problem" id="id25">Integral problem</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#expression-of-the-green-function" id="id26">Expression of the Green function</a></p>
<ul>
<li><p><a class="reference internal" href="#in-infinite-depth" id="id27">In infinite depth</a></p>
<ul>
<li><p><a class="reference internal" href="#green-function" id="id28">Green function</a></p></li>
<li><p><a class="reference internal" href="#variants-of-the-formulation" id="id29">Variants of the formulation</a></p></li>
<li><p><a class="reference internal" href="#gradient-of-the-green-function" id="id30">Gradient of the Green function</a></p></li>
<li><p><a class="reference internal" href="#higher-order-derivative" id="id31">Higher order derivative</a></p></li>
<li><p><a class="reference internal" href="#delhommeau-s-method-for-computation" id="id32">Delhommeau’s method for computation</a></p></li>
<li><p><a class="reference internal" href="#integration" id="id33">Integration</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#in-finite-depth" id="id34">In finite depth</a></p>
<ul>
<li><p><a class="reference internal" href="#id14" id="id35">Green function</a></p></li>
<li><p><a class="reference internal" href="#id15" id="id36">Gradient of the Green function</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#symmetries" id="id37">Symmetries</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#discretization" id="id38">Discretization</a></p></li>
<li><p><a class="reference internal" href="#problem-with-forward-speed" id="id39">Problem with forward speed</a></p></li>
<li><p><a class="reference internal" href="#post-processing" id="id40">Post-processing</a></p>
<ul>
<li><p><a class="reference internal" href="#forces-on-body-surfaces" id="id41">Forces on body surfaces</a></p></li>
<li><p><a class="reference internal" href="#dynamic-coupling-and-impedance" id="id42">Dynamic coupling and impedance</a></p></li>
<li><p><a class="reference internal" href="#free-surface-elevation" id="id43">Free surface elevation</a></p></li>
<li><p><a class="reference internal" href="#far-field-coefficients" id="id44">Far-field coefficients</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
<section id="linear-boundary-value-problem">
<h2><a class="toc-backref" href="#id22" role="doc-backlink">Linear boundary value problem</a><a class="headerlink" href="#linear-boundary-value-problem" title="Link to this heading">¶</a></h2>
<section id="hypotheses">
<h3><a class="toc-backref" href="#id23" role="doc-backlink">Hypotheses</a><a class="headerlink" href="#hypotheses" title="Link to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>The fluid is inviscid.</p></li>
<li><p>The fluid is incompressible: <span class="math notranslate nohighlight">\(\nabla \cdot u = 0\)</span> with <span class="math notranslate nohighlight">\(u\)</span> the flow velocity.</p></li>
<li><p>The flow is irrotational: <span class="math notranslate nohighlight">\(\nabla \times u = 0\)</span>.</p></li>
<li><p>The wave amplitude is small with respect to the wavelength.</p></li>
<li><p>The amplitude of the body motion is small with respect to its dimension.</p></li>
<li><p>The sea bottom is flat. The water depth is denoted <span class="math notranslate nohighlight">\(h\)</span>.</p></li>
</ol>
</section>
<section id="mathematical-problem">
<h3><a class="toc-backref" href="#id24" role="doc-backlink">Mathematical problem</a><a class="headerlink" href="#mathematical-problem" title="Link to this heading">¶</a></h3>
<p>The mass conservation equation can be rewritten as the Laplace equation</p>
<div class="math notranslate nohighlight" id="equation-laplace">
<span class="eqno">(13)<a class="headerlink" href="#equation-laplace" title="Link to this equation">¶</a></span>\[\nabla^2 \phi = 0,\]</div>
<p>where <span class="math notranslate nohighlight">\(\phi\)</span> is the velocity potential defined as <span class="math notranslate nohighlight">\(u = \nabla \phi\)</span>.</p>
<p>Since the problem is linear, we look for a solution in the frequency domain:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-0">
<span class="eqno">(14)<a class="headerlink" href="#equation-theory-manual-theory-0" title="Link to this equation">¶</a></span>\[\phi = \mathrm{Re} \left( \Phi e^{-i \omega t} \right).\]</div>
<p>The partial differential equation <a class="reference internal" href="#equation-laplace">(13)</a> is completed with the following boundary conditions:</p>
<ul class="simple">
<li><p>linearized free surface boundary condition:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-bc-fs">
<span class="eqno">(15)<a class="headerlink" href="#equation-bc-fs" title="Link to this equation">¶</a></span>\[g \frac{\partial \Phi}{\partial z} - \omega^2 \Phi = 0, \qquad \text{on } z = 0.\]</div>
<ul class="simple">
<li><p>no velocity boundary condition at the (flat) sea bottom:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-bc-bottom">
<span class="eqno">(16)<a class="headerlink" href="#equation-bc-bottom" title="Link to this equation">¶</a></span>\[\frac{\partial \Phi}{\partial z} = 0, \qquad \text{on } z = -h.\]</div>
<ul class="simple">
<li><p>a given velocity <span class="math notranslate nohighlight">\(u\)</span> on the floating body surface <span class="math notranslate nohighlight">\(\Gamma\)</span>:</p></li>
</ul>
<div class="math notranslate nohighlight" id="equation-bc-body">
<span class="eqno">(17)<a class="headerlink" href="#equation-bc-body" title="Link to this equation">¶</a></span>\[\nabla \Phi \cdot n = u \cdot n, \qquad \text{on } \Gamma,\]</div>
<p>where <span class="math notranslate nohighlight">\(n\)</span> denotes the normal vector at the surface of the floating body.</p>
<p>The normal velocity on the floating body surface is the input of the problem.
It depends on the type of problem:</p>
<dl>
<dt><strong>Radiation problem</strong>:</dt><dd><p>For the radiation problem, the normal velocity on the body surface corresponds to the motion of the body along one of its degrees of freedom.
The resolution of the Laplace problem allows to derive the added mass and the radiation damping associated with this degree of freedom (see also <a class="reference internal" href="#post-processing">Post-processing</a>).</p>
</dd>
<dt><strong>Diffraction problem</strong>:</dt><dd><p>For the diffraction problem, the velocity on the floating body is given by the velocity of Airy’s wave field.
Once the problem has been solved, the linear Froude-Krylov force is computed by the integration of the pressure (<span class="math notranslate nohighlight">\(p = i \rho \omega \Phi\)</span>) on the floating body (see also <a class="reference internal" href="#post-processing">Post-processing</a>).</p>
<p>The incoming Airy’s wave fields is given by</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-1">
<span class="eqno">(18)<a class="headerlink" href="#equation-theory-manual-theory-1" title="Link to this equation">¶</a></span>\[\Phi_0 = - i \frac{g}{\omega} \frac{\cosh (k (z+h))}{\cosh (k h)} e^{i k (x \cos \beta + y \sin \beta)}\]</div>
<p>in finite depth, where the wave number <span class="math notranslate nohighlight">\(k\)</span> is defined by the dispersion relation <span class="math notranslate nohighlight">\(\omega^2 = k g \tanh (k h)\)</span>, and by</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-2">
<span class="eqno">(19)<a class="headerlink" href="#equation-theory-manual-theory-2" title="Link to this equation">¶</a></span>\[\Phi_0 = - i \frac{g}{\omega} e^{k z} e^{i k (x \cos \beta + y \sin \beta)}\]</div>
<p>in infinite depth, where the wave number <span class="math notranslate nohighlight">\(k\)</span> is defined by <span class="math notranslate nohighlight">\(\omega^2 = k g\)</span>.</p>
<p>In the above equations, <span class="math notranslate nohighlight">\(\beta\)</span> is the angle of the incoming wave.
The angle <span class="math notranslate nohighlight">\(\beta = 0\)</span> corresponds to waves propagating in the <span class="math notranslate nohighlight">\(x\)</span> direction from <span class="math notranslate nohighlight">\(x=-\infty\)</span> to <span class="math notranslate nohighlight">\(x=+\infty\)</span>.
The angle <span class="math notranslate nohighlight">\(\beta = \pi/2\)</span> corresponds to waves propagating in the <span class="math notranslate nohighlight">\(y\)</span> direction from <span class="math notranslate nohighlight">\(y=-\infty\)</span> to <span class="math notranslate nohighlight">\(y=+\infty\)</span>.</p>
</dd>
</dl>
</section>
<section id="integral-problem">
<h3><a class="toc-backref" href="#id25" role="doc-backlink">Integral problem</a><a class="headerlink" href="#integral-problem" title="Link to this heading">¶</a></h3>
<p>The partial differential equation can be rewritten as a boundary integral problem.
Let us introduce the Green function <span class="math notranslate nohighlight">\(G(\xi, \cdot)\)</span>, which is solution of the partial differential equation:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-3">
<span class="eqno">(20)<a class="headerlink" href="#equation-theory-manual-theory-3" title="Link to this equation">¶</a></span>\[\nabla^2 G(x; \xi) = \delta(\xi - x), \qquad \forall x,\]</div>
<p>where the <span class="math notranslate nohighlight">\(\nabla\)</span> is meant as the derivative with respect to <span class="math notranslate nohighlight">\(x\)</span>.</p>
<p>The above equation is associated with the boundary condition <a class="reference internal" href="#equation-bc-fs">(15)</a> and <a class="reference internal" href="#equation-bc-bottom">(16)</a>, where <span class="math notranslate nohighlight">\(\xi\)</span> is a given point in the domain and <span class="math notranslate nohighlight">\(\delta\)</span> is the Dirac distribution.</p>
<p>With the help of this Green function <span class="math notranslate nohighlight">\(G\)</span>, the potential of the surface of the floating body <span class="math notranslate nohighlight">\(\Gamma\)</span> can be rewritten as a function of a source distribution <span class="math notranslate nohighlight">\(\sigma\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-potential-representation">
<span class="eqno">(21)<a class="headerlink" href="#equation-potential-representation" title="Link to this equation">¶</a></span>\[\Phi(x) = \iint_\Gamma \sigma(\xi) G(x; \xi) \, \mathrm{dS}(\xi)\]</div>
<p>for all point <span class="math notranslate nohighlight">\(x\)</span> in the fluid or on the hull of the floating body <span class="math notranslate nohighlight">\(\Gamma\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>There is a typo in equation <a class="reference internal" href="#equation-potential-representation">(21)</a> in <a class="reference internal" href="bibliography.html#bd15" id="id6"><span>[BD15]</span></a>.</p>
</div>
<p>The integral on the other boundaries of the domain is zero due to the properties of the Green function.</p>
<p>The differentiation of <a class="reference internal" href="#equation-potential-representation">(21)</a> differs depending whether <span class="math notranslate nohighlight">\(x\)</span> is in the bulk of the fluid or on the hull.</p>
<p>On the hull, one has <a class="reference internal" href="bibliography.html#del87" id="id7"><span>[Del87]</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-normal-velocity-on-hull-representation">
<span class="eqno">(22)<a class="headerlink" href="#equation-normal-velocity-on-hull-representation" title="Link to this equation">¶</a></span>\[\frac{\partial \Phi}{\partial n}(x) = (u \cdot n)(x) = \frac{\sigma(x)}{2} + \iint_\Gamma \sigma(\xi) \, (\nabla G(x; \xi) \cdot n) \, \mathrm{dS}(\xi).\]</div>
<p>where <span class="math notranslate nohighlight">\(x\)</span> is a point on <span class="math notranslate nohighlight">\(\Gamma\)</span> and <span class="math notranslate nohighlight">\(n\)</span> is the vector normal to <span class="math notranslate nohighlight">\(\Gamma\)</span> in <span class="math notranslate nohighlight">\(x\)</span>.
For any vector <span class="math notranslate nohighlight">\(t\)</span> tangential to <span class="math notranslate nohighlight">\(\Gamma\)</span> at <span class="math notranslate nohighlight">\(x\)</span>, one has</p>
<div class="math notranslate nohighlight" id="equation-tangential-velocity-on-hull-representation">
<span class="eqno">(23)<a class="headerlink" href="#equation-tangential-velocity-on-hull-representation" title="Link to this equation">¶</a></span>\[\frac{\partial \Phi}{\partial t}(x) = (u \cdot t)(x) = \iint_\Gamma \sigma(\xi) \, (\nabla G(x; \xi) \cdot t) \, \mathrm{dS}(\xi).\]</div>
<p>Finally, for <span class="math notranslate nohighlight">\(x\)</span> in the bulk of the fluid, one has</p>
<div class="math notranslate nohighlight" id="equation-velocity-in-bulk-representation">
<span class="eqno">(24)<a class="headerlink" href="#equation-velocity-in-bulk-representation" title="Link to this equation">¶</a></span>\[\nabla \Phi(x) = u(x) = \iint_\Gamma \sigma(\xi) \, \nabla G(x; \xi) \, \mathrm{dS}(\xi).\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Dimensional analysis:</p>
<p><span class="math notranslate nohighlight">\(\Phi\)</span> is in m²·s¯¹.</p>
<p><span class="math notranslate nohighlight">\(\sigma\)</span> is in m·s¯¹.</p>
<p><span class="math notranslate nohighlight">\(G\)</span> is in m¯¹.</p>
</div>
</section>
</section>
<section id="expression-of-the-green-function">
<h2><a class="toc-backref" href="#id26" role="doc-backlink">Expression of the Green function</a><a class="headerlink" href="#expression-of-the-green-function" title="Link to this heading">¶</a></h2>
<section id="in-infinite-depth">
<h3><a class="toc-backref" href="#id27" role="doc-backlink">In infinite depth</a><a class="headerlink" href="#in-infinite-depth" title="Link to this heading">¶</a></h3>
<p>The integral problem above relates the potential <span class="math notranslate nohighlight">\(\Phi\)</span> to the normal velocity
<span class="math notranslate nohighlight">\(u \cdot n\)</span> via the Green function <span class="math notranslate nohighlight">\(G\)</span>. Let us know discuss the evaluation of this
function for an infinite water depth.
See also <a class="reference internal" href="bibliography.html#x18" id="id8"><span>[X18]</span></a>.</p>
<section id="green-function">
<h4><a class="toc-backref" href="#id28" role="doc-backlink">Green function</a><a class="headerlink" href="#green-function" title="Link to this heading">¶</a></h4>
<p>The infinite depth Green function takes the following form</p>
<div class="math notranslate nohighlight" id="equation-green-function-inf-depth">
<span class="eqno">(25)<a class="headerlink" href="#equation-green-function-inf-depth" title="Link to this equation">¶</a></span>\[G(\xi, x) = - \frac{1}{4 \pi} \left( \frac{1}{\|x - \xi\|} + k \mathcal{G}\left(k \sqrt{(x_1 - \xi_1)^2 + (x_2 - \xi_2)^2}, k (x_3 + \xi_3) \right) \right)\]</div>
<div class="proof property admonition" id="property-0">
<p class="admonition-title"><span class="caption-number">Property 1 </span></p>
<section class="property-content" id="proof-content">
<p>The function <span class="math notranslate nohighlight">\(G\)</span> is symmetric in the sense of</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-4">
<span class="eqno">(26)<a class="headerlink" href="#equation-theory-manual-theory-4" title="Link to this equation">¶</a></span>\[\forall x, \xi, \quad G(x, \xi) = G(\xi, x).\]</div>
</section>
</div><p>The first term of <span class="math notranslate nohighlight">\(G\)</span> is the usual Green function for the 3D Laplace equation without our specific boundary conditions.
The <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> term is complex-valued and it is introduced to satisfy the boundary conditions <a class="reference internal" href="#equation-bc-fs">(15)</a>.</p>
<p>Introducing the dimensionless variables <span class="math notranslate nohighlight">\(r = k \sqrt{(\xi_1 - x_1)^2 + (\xi_2 - x_2)^2}\)</span> and <span class="math notranslate nohighlight">\(z = k (x_3 + \xi_3)\)</span>, this term reads</p>
<div class="math notranslate nohighlight" id="equation-green-function-inf-depth-low-freq">
<span class="eqno">(27)<a class="headerlink" href="#equation-green-function-inf-depth-low-freq" title="Link to this equation">¶</a></span>\[\begin{split}\mathcal{G}(r, z) &amp; = \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \Re \left( \int^{\pi/2}_{-\pi/2}  J(\zeta(r, z, \theta)) \, \mathrm{d} \theta \right) \\
&amp; \qquad \qquad \qquad \qquad + 2 i \Re \left( \int^{\pi/2}_{-\pi/2} e^{\zeta (r, z, \theta)} \, \mathrm{d} \theta \right)\end{split}\]</div>
<p>where</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-5">
<span class="eqno">(28)<a class="headerlink" href="#equation-theory-manual-theory-5" title="Link to this equation">¶</a></span>\[J(\zeta) = e^\zeta \left[ E_1(\zeta) + i \pi \right]\]</div>
<p>where <span class="math notranslate nohighlight">\(E_1\)</span> is the first exponential integral, defined as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-6">
<span class="eqno">(29)<a class="headerlink" href="#equation-theory-manual-theory-6" title="Link to this equation">¶</a></span>\[E_1(\zeta) = \int_\zeta^\infty \frac{e^{-t}}{t} dt,\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-def-zeta">
<span class="eqno">(30)<a class="headerlink" href="#equation-def-zeta" title="Link to this equation">¶</a></span>\[\zeta (r, z, \theta) = z + i r \cos \theta.\]</div>
<p>The first term of <a class="reference internal" href="#equation-green-function-inf-depth-low-freq">(27)</a> is actually a Rankine-type singularity similar to the first term of <a class="reference internal" href="#equation-green-function-inf-depth">(25)</a>, except that one of the point has been reflected through the free surface.</p>
</section>
<section id="variants-of-the-formulation">
<h4><a class="toc-backref" href="#id29" role="doc-backlink">Variants of the formulation</a><a class="headerlink" href="#variants-of-the-formulation" title="Link to this heading">¶</a></h4>
<div class="proof lemma admonition" id="integrate-one-over-zeta">
<p class="admonition-title"><span class="caption-number">Lemma 1 </span></p>
<section class="lemma-content" id="proof-content">
<blockquote>
<div><p>The following identity holds <a class="reference internal" href="bibliography.html#del89" id="id9"><span>[Del89]</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-int-1-over-zeta">
<span class="eqno">(31)<a class="headerlink" href="#equation-int-1-over-zeta" title="Link to this equation">¶</a></span>\[\Re \int^{\pi/2}_{-\pi/2} \frac{1}{\zeta(\theta)} \, \mathrm{d} \theta = - \frac{\pi}{\sqrt{r^2 + z^2}}.\]</div>
</div></blockquote>
</section>
</div><p>The above lemma allows to retrieve the expression of the Green function found e.g. in <a class="reference internal" href="bibliography.html#bd15" id="id10"><span>[BD15]</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-green-function-inf-depth-high-freq">
<span class="eqno">(32)<a class="headerlink" href="#equation-green-function-inf-depth-high-freq" title="Link to this equation">¶</a></span>\[\begin{split}\mathcal{G}(r, z) &amp; = - \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \Re \left( \int^{\pi/2}_{-\pi/2} \left( J(\zeta(r, z, \theta)) - \frac{1}{\zeta(r, z, \theta)} \right) \, \mathrm{d} \theta \right) \\
&amp; \qquad \qquad \qquad \qquad + 2 i \Re \left( \int^{\pi/2}_{-\pi/2} e^{\zeta (r, z, \theta)} \, \mathrm{d} \theta \right)\end{split}\]</div>
<p>(Note the minus sign in front of the first term.)</p>
<div class="proof lemma admonition" id="lemma-2">
<p class="admonition-title"><span class="caption-number">Lemma 2 </span></p>
<section class="lemma-content" id="proof-content">
<p>The <a class="reference external" href="https://personal.math.ubc.ca/~cbm/aands/page_360.htm">zeroth order Bessel function of the first kind</a> <span class="math notranslate nohighlight">\(J_0\)</span> and <a class="reference external" href="https://personal.math.ubc.ca/~cbm/aands/page_496.htm">the Struve function</a> <span class="math notranslate nohighlight">\(H_0\)</span> are such that</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-7">
<span class="eqno">(33)<a class="headerlink" href="#equation-theory-manual-theory-7" title="Link to this equation">¶</a></span>\[\begin{split}J_0(r) &amp; = \frac{1}{\pi} \int_{-\pi/2}^{\pi/2} \cos(r\cos(\theta)) \, \mathrm{d} \theta \\
H_0(r) &amp; = \frac{1}{\pi} \int_{-\pi/2}^{\pi/2} \sin(r\cos(\theta)) \, \mathrm{d} \theta \\\end{split}\]</div>
<p>hence</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-8">
<span class="eqno">(34)<a class="headerlink" href="#equation-theory-manual-theory-8" title="Link to this equation">¶</a></span>\[\int_{-\pi/2}^{\pi/2} i e^{\zeta} \, \mathrm{d} \theta = \pi e^z \left(- H_0(r) + i J_0(r) \right)\]</div>
</section>
</div><p>The function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> can also be rewritten as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-9">
<span class="eqno">(35)<a class="headerlink" href="#equation-theory-manual-theory-9" title="Link to this equation">¶</a></span>\[\begin{split}\mathcal{G}(r, z) &amp; = \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \int^{\pi/2}_{-\pi/2} \Re \left( e^\zeta E_1(\zeta) \right) \, \mathrm{d} \theta + 2 \int^{\pi/2}_{-\pi/2} i e^{\zeta (r, z, \theta)} \, \mathrm{d} \theta \\
&amp; = \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \int^{\pi/2}_{-\pi/2} \Re \left( e^\zeta E_1(\zeta) \right) \, \mathrm{d} \theta + 2 \pi e^z \left( - H_0(r) + i J_0(r) \right)\end{split}\]</div>
<p>Noblesse <a class="reference internal" href="bibliography.html#n82" id="id11"><span>[N82]</span></a> splits the function <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> into a near field term <span class="math notranslate nohighlight">\(N\)</span> and a wave field <span class="math notranslate nohighlight">\(W\)</span> such that</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-10">
<span class="eqno">(36)<a class="headerlink" href="#equation-theory-manual-theory-10" title="Link to this equation">¶</a></span>\[\begin{split}N(r, z) &amp; = \frac{1}{\sqrt{r^2 + z^2}} + \frac{2}{\pi} \int^{\pi/2}_{-\pi/2} \Re \left( e^\zeta E_1(\zeta)  \right) \, \mathrm{d} \theta  \\
W(r, z) &amp; = 2 \pi e^z \left( - H_0(r) + i J_0(r) \right)\end{split}\]</div>
<p>Note that <span class="math notranslate nohighlight">\(E_1\)</span>, <span class="math notranslate nohighlight">\(J_0\)</span> and <span class="math notranslate nohighlight">\(H_0\)</span> are available for instance in the <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/special.html">Scipy library</a>.</p>
<div class="proof lemma admonition" id="lemma-3">
<p class="admonition-title"><span class="caption-number">Lemma 3 </span></p>
<section class="lemma-content" id="proof-content">
<p>For any function <span class="math notranslate nohighlight">\(f\)</span>, the following two formulations of the integral are equivalent <a class="reference internal" href="bibliography.html#del89" id="id12"><span>[Del89]</span></a>:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-11">
<span class="eqno">(37)<a class="headerlink" href="#equation-theory-manual-theory-11" title="Link to this equation">¶</a></span>\[\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} f \left(\zeta(\theta) \right) \mathrm{d} \theta =
\int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} f \left(\tilde{\zeta}(\theta) \right) \mathrm{d} \theta\]</div>
<p>where <span class="math notranslate nohighlight">\(\zeta\)</span> is defined in <a class="reference internal" href="#equation-def-zeta">(30)</a> and <span class="math notranslate nohighlight">\(\tilde{\zeta}\)</span> is defined as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-12">
<span class="eqno">(38)<a class="headerlink" href="#equation-theory-manual-theory-12" title="Link to this equation">¶</a></span>\[\tilde{\zeta} (\theta) = k \left( x_3 + \xi_3 + i \left( (x_1 - \xi_1) \cos\theta + (x_2 - \xi_2) \sin\theta \right) \right).\]</div>
</section>
</div><div class="proof admonition" id="proof">
<p>Proof. Let us note that:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-13">
\begin{align*}
(x_1 - \xi_1) \cos(\theta) + (x_2 - \xi_2) \sin(\theta) &amp; = \Re \left( \left( x_1 - \xi_1  + i (x_2 - \xi_2) \right) e^{-i \theta} \right) \\
             &amp; = \Re \left( r e^{i (\alpha - \theta)} \right) \\
             &amp; = r \cos \left( \alpha - \theta \right) \\
\end{align*}</div><p>where <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(\alpha\)</span> are defined by</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-14">
\[
    r e^{i \alpha} = (x_1 - \xi_1)  + i (x_2 - \xi_2).
\]</div><p>Finally note that:</p>
<blockquote>
<div><div class="math notranslate nohighlight" id="equation-theory-manual-theory-15">
\[
    \int_{-\frac{\pi}{2}-\alpha}^{\frac{\pi}{2}-\alpha} f \left(\zeta(\theta) \right) \mathrm{d} \theta =
    \int_{-\frac{\pi}{2}}^{\frac{\pi}{2}} f \left(\zeta(\theta) \right) \mathrm{d} \theta
\]</div></div></blockquote>
</div>
</section>
<section id="gradient-of-the-green-function">
<h4><a class="toc-backref" href="#id30" role="doc-backlink">Gradient of the Green function</a><a class="headerlink" href="#gradient-of-the-green-function" title="Link to this heading">¶</a></h4>
<p>The gradient of the Green function can be written as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-16">
<span class="eqno">(42)<a class="headerlink" href="#equation-theory-manual-theory-16" title="Link to this equation">¶</a></span>\[\begin{split}\nabla_x G(\xi, x) = - \frac{1}{4 \pi} \left( - \frac{x - \xi}{\|x - \xi\|^3} + k
   \begin{pmatrix}
     \frac{\partial r}{\partial x_1} \frac{\partial \mathcal{G}}{\partial r} \\
     \frac{\partial r}{\partial x_2} \frac{\partial \mathcal{G}}{\partial r} \\
     \frac{\partial z}{\partial x_3} \frac{\partial \mathcal{G}}{\partial z}
   \end{pmatrix}
\right)\end{split}\]</div>
<p>with</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-17">
<span class="eqno">(43)<a class="headerlink" href="#equation-theory-manual-theory-17" title="Link to this equation">¶</a></span>\[\begin{split}\frac{\partial r}{\partial x_1} &amp; = k^2 \frac{x_1 - \xi_1}{r} \\
\frac{\partial r}{\partial x_2} &amp; = k^2 \frac{x_2 - \xi_2}{r} \\
\frac{\partial z}{\partial x_3} &amp; = k\end{split}\]</div>
<p>and, using the identity <span class="math notranslate nohighlight">\(J'(\zeta) = J(\zeta) - 1/\zeta\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-18">
<span class="eqno">(44)<a class="headerlink" href="#equation-theory-manual-theory-18" title="Link to this equation">¶</a></span>\[\begin{split}\frac{\partial \mathcal{G}}{\partial r} = &amp; - \frac{r}{(r^2 + z^2)^{3/2}} + \frac{2}{\pi} \Re \left( \int_{-\pi/2}^{\pi/2} i \cos(\theta) \left( J(\zeta) - \frac{1}{\zeta} \right) \, \mathrm{d}\theta \right) \\
&amp; \qquad \qquad \qquad \qquad + 2 i \Re \left( \int^{\pi/2}_{-\pi/2} i \cos(\theta) e^{\zeta} \, \mathrm{d} \theta \right)\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-19">
<span class="eqno">(45)<a class="headerlink" href="#equation-theory-manual-theory-19" title="Link to this equation">¶</a></span>\[\begin{split}\frac{\partial \mathcal{G}}{\partial z} = &amp; - \frac{z}{(r^2 + z^2)^{3/2}} + \frac{2}{\pi} \Re \left( \int_{-\pi/2}^{\pi/2} \left( J(\zeta) - \frac{1}{\zeta} \right) \, \mathrm{d}\theta \right) \\
 &amp; \qquad \qquad \qquad \qquad + 2 i \Re \left( \int^{\pi/2}_{-\pi/2} e^{\zeta } \, \mathrm{d} \theta \right) \\\end{split}\]</div>
<p>that is, using <a class="reference internal" href="#integrate-one-over-zeta">Lemma 1</a></p>
<div class="math notranslate nohighlight" id="equation-green-function-inf-depth-dgdz">
<span class="eqno">(46)<a class="headerlink" href="#equation-green-function-inf-depth-dgdz" title="Link to this equation">¶</a></span>\[\frac{\partial \mathcal{G}}{\partial z} = \mathcal{G}(r, z) + \frac{2}{\sqrt{r^2 + z^2}} - \frac{z}{(r^2 + z^2)^{3/2}}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The derivative of <span class="math notranslate nohighlight">\(G\)</span> with respect to <span class="math notranslate nohighlight">\(x_1\)</span> and <span class="math notranslate nohighlight">\(x_2\)</span> are antisymmetric in the sense of</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-20">
 \[
 \frac{\partial G}{\partial x_1} (\xi, x) = - \frac{\partial G}{\partial x_1}(x, \xi).
 \]</div><p>Its derivative with respect to <span class="math notranslate nohighlight">\(x_3\)</span> is symmetric in infinite depth.</p>
<p>In finite depth, some terms of the derivative with respect to <span class="math notranslate nohighlight">\(x_3\)</span> are symmetric and some are antisymmetric.</p>
</div>
</section>
<section id="higher-order-derivative">
<h4><a class="toc-backref" href="#id31" role="doc-backlink">Higher order derivative</a><a class="headerlink" href="#higher-order-derivative" title="Link to this heading">¶</a></h4>
<p>From <a class="reference internal" href="#equation-green-function-inf-depth-dgdz">(46)</a>, one has</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-21">
<span class="eqno">(48)<a class="headerlink" href="#equation-theory-manual-theory-21" title="Link to this equation">¶</a></span>\[\begin{split}\frac{\partial \mathcal{G}}{\partial z} &amp;= \mathcal{G}(r, z) + \left( 1 + \frac{\partial}{\partial z} \right) \frac{1}{\sqrt{r^2 + z^2}} \\
\frac{\partial^2 \mathcal{G}}{\partial z \partial r} &amp;= \frac{\partial \mathcal{G}}{\partial r} + \left( \frac{\partial}{\partial r} + \frac{\partial^2}{\partial z \partial r} \right) \frac{1}{\sqrt{r^2 + z^2}}\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-22">
<span class="eqno">(49)<a class="headerlink" href="#equation-theory-manual-theory-22" title="Link to this equation">¶</a></span>\[\begin{split}\frac{\partial^2 \mathcal{G}}{\partial z^2} &amp;= \mathcal{G}(r, z) + \left( 1 + 2 \frac{\partial}{\partial z} + \frac{\partial^2}{\partial z^2} \right)\frac{1}{\sqrt{r^2 + z^2}} \\
                                            &amp;= \mathcal{G}(r, z) + \frac{1}{\sqrt{r^2 + z^2}} - 2 \frac{z}{(r^2 + z^2)^{3/2}} - \frac{r^2 - 2 z^2}{(r^2 + z^2)^{5/2}}\end{split}\]</div>
<p>Since the Green function is solution of the Laplace equation, it follows that</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-23">
<span class="eqno">(50)<a class="headerlink" href="#equation-theory-manual-theory-23" title="Link to this equation">¶</a></span>\[\frac{\partial^2 \mathcal{G}}{\partial r^2} + \frac{1}{r} \frac{\partial \mathcal{G}}{\partial r} + \frac{\partial^2 \mathcal{G}}{\partial z^2} = 0\]</div>
<p>then</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-24">
<span class="eqno">(51)<a class="headerlink" href="#equation-theory-manual-theory-24" title="Link to this equation">¶</a></span>\[\begin{split}\frac{\partial^2 \mathcal{G}}{\partial r^2} = - \frac{1}{r} \frac{\partial \mathcal{G}}{\partial r} - \mathcal{G} - \left( 1 + 2 \frac{\partial}{\partial z} + \frac{\partial^2}{\partial z^2} \right)\frac{1}{\sqrt{r^2 + z^2}} \\\end{split}\]</div>
<p>All higher order derivative can be expressed with the help of <span class="math notranslate nohighlight">\(\mathcal{G}\)</span> and <span class="math notranslate nohighlight">\(\frac{\partial \mathcal{G}}{\partial r}\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The same derivation is done in e.g. <a class="reference internal" href="bibliography.html#n20" id="id13"><span>[N20]</span></a> using instead the function <span class="math notranslate nohighlight">\(F = \mathcal{G} - \frac{1}{\sqrt{r^2 + z^2}}\)</span> for which the expressions are slightly simpler.</p>
</div>
</section>
<section id="delhommeau-s-method-for-computation">
<h4><a class="toc-backref" href="#id32" role="doc-backlink">Delhommeau’s method for computation</a><a class="headerlink" href="#delhommeau-s-method-for-computation" title="Link to this heading">¶</a></h4>
<p>The current version of Capytaine can use either the low-frequency variant <a class="reference internal" href="#equation-green-function-inf-depth-low-freq">(27)</a> or high-frequency variant <a class="reference internal" href="#equation-green-function-inf-depth-high-freq">(32)</a> when evaluating the Green function and its integral over a panel.
For this purpose, the following values needs to be computed:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-25">
<span class="eqno">(52)<a class="headerlink" href="#equation-theory-manual-theory-25" title="Link to this equation">¶</a></span>\[\begin{split}I_1(r, z) &amp; = \frac{2}{\pi} \Re \left( \int^{\pi/2}_{-\pi/2} J(\zeta) \, \mathrm{d} \theta \right) \\
I_2(r, z) &amp; = \frac{2}{\pi} \Re \left( \int^{\pi/2}_{-\pi/2} \left( J(\zeta) - \frac{1}{\zeta} \right) \, \mathrm{d} \theta \right) \\
I_3(r, z) &amp; = 2 \Re \left( \int^{\pi/2}_{-\pi/2} e^{\zeta} \, \mathrm{d} \theta \right) \\
I_4(r, z) &amp; = \frac{2}{\pi} \Re \left( \int^{\pi/2}_{-\pi/2} i \cos(\theta) \left( J(\zeta) - \frac{1}{\zeta} \right) \, \mathrm{d} \theta \right) \\
I_5(r, z) &amp; = 2 \Re \left( \int^{\pi/2}_{-\pi/2} i \cos(\theta) e^{\zeta} \, \mathrm{d} \theta \right)\end{split}\]</div>
<p>then <a class="reference internal" href="#equation-green-function-inf-depth-low-freq">(27)</a> reads</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-26">
<span class="eqno">(53)<a class="headerlink" href="#equation-theory-manual-theory-26" title="Link to this equation">¶</a></span>\[\mathcal{G}(r, z) = \frac{1}{\sqrt{r^2 + z^2}} + I_1(r, z) + i I_3(r, z).\]</div>
<p>and <a class="reference internal" href="#equation-green-function-inf-depth-high-freq">(32)</a> reads</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-27">
<span class="eqno">(54)<a class="headerlink" href="#equation-theory-manual-theory-27" title="Link to this equation">¶</a></span>\[\mathcal{G}(r, z) = \frac{-1}{\sqrt{r^2 + z^2}} + I_2(r, z) + i I_3(r, z).\]</div>
<p>To limit the computational cost of the evaluation of these integrals, they are precomputed for selected values of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(z\)</span> and stored in a table.
When evaluating the Green function, the values of the integrals are retrieved by interpolating the values in the tables.</p>
<p>For large values of <span class="math notranslate nohighlight">\(r\)</span> and <span class="math notranslate nohighlight">\(z\)</span>, these integrals are asymptotically approximated by the following expressions:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-28">
<span class="eqno">(55)<a class="headerlink" href="#equation-theory-manual-theory-28" title="Link to this equation">¶</a></span>\[\begin{split}I_1(r, z) &amp; \simeq - 2 e^z \sqrt{\frac{2\pi}{r}} \sin(r - \pi/4) + \frac{2 z}{(r^2 + z^2)^{3/2}} - \frac{2}{\sqrt{r^2 + z^2}} \\
I_2(r, z) &amp; \simeq - 2 e^z \sqrt{\frac{2\pi}{r}} \sin(r - \pi/4) + \frac{2 z}{(r^2 + z^2)^{3/2}} \\
I_3(r, z) &amp; \simeq 2 e^z \sqrt{\frac{2\pi}{r}} \cos(r - \pi/4) \\
I_4(r, z) &amp; \simeq - 2 e^z \sqrt{\frac{2\pi}{r}} \left( \cos(r - \pi/4) - \frac{1}{2r} \sin(r-\pi/4) \right) + \frac{2 r}{(r^2 + z^2)^{3/2}} \\
I_5(r, z) &amp; \simeq - 2 e^z \sqrt{\frac{2\pi}{r}} \left( \sin(r - \pi/4) + \frac{1}{2r} \cos(r - \pi/4) \right)\end{split}\]</div>
<p>Incorporating these asymptotic approximation in the expression of the Green function, one gets:</p>
<div class="math notranslate nohighlight" id="equation-green-function-asymptotical-approx">
<span class="eqno">(56)<a class="headerlink" href="#equation-green-function-asymptotical-approx" title="Link to this equation">¶</a></span>\[\begin{split}\mathcal{G}(r, z) \simeq &amp; -\frac{1}{\sqrt{r^2 + z^2}} - 2 e^z \sqrt{\frac{2\pi}{r}} \left(\sin(r - \pi/4) - i\cos(r - \pi/4)\right) \\
&amp; \qquad\qquad\qquad\qquad + 2 \frac{z}{(r^2 + z^2)^{3/2}}\end{split}\]</div>
</section>
<section id="integration">
<h4><a class="toc-backref" href="#id33" role="doc-backlink">Integration</a><a class="headerlink" href="#integration" title="Link to this heading">¶</a></h4>
<p>TODO</p>
<p>As seen in <a class="reference internal" href="#equation-green-function-inf-depth-dgdz">(46)</a>, new reflected-Rankine-type
terms might appear in the derivative of the Green wave term.
By default, they are integrated with the same method used for the same
numerical quadrature method as the rest of the wave term.
The setting <code class="docutils literal notranslate"><span class="pre">gf_singularities=&quot;low_freq_with_rankine_term&quot;</span></code> is an attempt to
integrate them exactly using the same code as the main reflected Rankine term.</p>
</section>
</section>
<section id="in-finite-depth">
<h3><a class="toc-backref" href="#id34" role="doc-backlink">In finite depth</a><a class="headerlink" href="#in-finite-depth" title="Link to this heading">¶</a></h3>
<section id="id14">
<h4><a class="toc-backref" href="#id35" role="doc-backlink">Green function</a><a class="headerlink" href="#id14" title="Link to this heading">¶</a></h4>
<p>TODO</p>
</section>
<section id="id15">
<h4><a class="toc-backref" href="#id36" role="doc-backlink">Gradient of the Green function</a><a class="headerlink" href="#id15" title="Link to this heading">¶</a></h4>
<p>TODO</p>
</section>
</section>
<section id="symmetries">
<h3><a class="toc-backref" href="#id37" role="doc-backlink">Symmetries</a><a class="headerlink" href="#symmetries" title="Link to this heading">¶</a></h3>
<p>The first term of <a class="reference internal" href="#equation-green-function-inf-depth">(25)</a> is invariant under all rotations and translations, whereas the other terms are invariant under isometric transformations that don’t change the vertical coordinate (reflection across a vertical plane, rotation around a vertical axis, translation following an horizontal vector).</p>
</section>
</section>
<section id="discretization">
<h2><a class="toc-backref" href="#id38" role="doc-backlink">Discretization</a><a class="headerlink" href="#discretization" title="Link to this heading">¶</a></h2>
<p>The equations <a class="reference internal" href="#equation-potential-representation">(21)</a> and <a class="reference internal" href="#equation-normal-velocity-on-hull-representation">(22)</a> can be discretized using a collocation method.
Considering a mesh of the surface of the floating body <span class="math notranslate nohighlight">\(\Gamma = \cup_i \Gamma_i\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-29">
<span class="eqno">(57)<a class="headerlink" href="#equation-theory-manual-theory-29" title="Link to this equation">¶</a></span>\[\begin{split}\Phi_i   &amp; = \Phi(x_i), \\
\sigma_i &amp; = \sigma(x_i), \\
u_i      &amp; = (u \cdot n)(x_i) \\
S_{ij}   &amp; = \iint_{\Gamma_j} G(x_i, \xi) \mathrm{dS}(\xi), \\
K_{ij}   &amp; = \frac{\delta_{ij}}{2} + \iint_{\Gamma_j} \nabla_x G(x_i; \xi) \cdot n_i \, \mathrm{dS}(\xi),\end{split}\]</div>
<p>where for all <span class="math notranslate nohighlight">\(i\)</span>, <span class="math notranslate nohighlight">\(x_i\)</span> is the center of the face <span class="math notranslate nohighlight">\(\Gamma_i\)</span> and <span class="math notranslate nohighlight">\(n_i\)</span> is its normal vector.
Each element of the matrices <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(K\)</span> can be seen as the interaction between two faces of the mesh.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><span class="math notranslate nohighlight">\(K\)</span> should not be confused with the similar matrix <span class="math notranslate nohighlight">\(D\)</span> defined as:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-30">
<span class="eqno">(58)<a class="headerlink" href="#equation-theory-manual-theory-30" title="Link to this equation">¶</a></span>\[D_{ij} = \frac{\delta_{ij}}{2} + \iint_{\Gamma_j} \nabla_\xi G(x_i; \xi) \cdot n_j \, \mathrm{dS}(\xi).\]</div>
<p>Note that the derivation of <span class="math notranslate nohighlight">\(G\)</span> is done with respect to a different variable.</p>
<p>The matrix <span class="math notranslate nohighlight">\(D\)</span> is used in the <cite>direct</cite> boundary integral equation, as e.g. in HAMS <a class="reference internal" href="bibliography.html#liu19" id="id16"><span>[Liu19]</span></a>.
In the mathematical literature, <span class="math notranslate nohighlight">\(D\)</span> is also referred to as the <cite>double layer operator</cite> and <span class="math notranslate nohighlight">\(K\)</span> as the <cite>adjoint double layer operator</cite>.</p>
</div>
<p>The matrices <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(K\)</span> relates the vectors <span class="math notranslate nohighlight">\(\Phi\)</span>, <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(\sigma\)</span> through the following approximations of <a class="reference internal" href="#equation-potential-representation">(21)</a> and <a class="reference internal" href="#equation-normal-velocity-on-hull-representation">(22)</a>:</p>
<div class="math notranslate nohighlight" id="equation-discrete-bem-problem">
<span class="eqno">(59)<a class="headerlink" href="#equation-discrete-bem-problem" title="Link to this equation">¶</a></span>\[\Phi = S \sigma, \qquad u = K \sigma.\]</div>
<p>The resolution of the discrete problem with Nemoh consists of two main steps:</p>
<ol class="arabic simple">
<li><p>The evaluation of the coefficients of the complex-valued matrices <span class="math notranslate nohighlight">\(S\)</span> and <span class="math notranslate nohighlight">\(K\)</span></p></li>
<li><p>The resolution of the complex-valued linear problem <span class="math notranslate nohighlight">\(K \sigma = u\)</span>.</p></li>
</ol>
<p>Once <span class="math notranslate nohighlight">\(\sigma\)</span> has been computed, <span class="math notranslate nohighlight">\(\Phi\)</span> can be easily deduced.
Then other magnitudes such as the Froude-Krylov forces or the added mass can be derived.</p>
<figure class="align-default" id="id19">
<pre  class="mermaid">
        flowchart TD;
    h[Water depth] --&gt; gf(Assembling matrices);
    ω[Wave frequency ω] --&gt; gf(Assembling matrices);
    m[Mesh] --&gt; gf;
    gf -- K matrix --&gt; ls(Linear solver);
    un[Normal velocity on hull] --&gt; ls;
    gf -- S matrix --&gt; mvp(Matrix vector product);
    ls -- sources distribution σ --&gt; mvp;
    mvp -- potential distribution Φ --&gt; int(&quot;Integrate on mesh&quot;);
    m --&gt; int;
    int --&gt; f[&quot;Hydrodynamic forces\n(aka added mass and radiation damping)&quot;]

    classDef input fill:#DDDDDD,color:#333333,stroke:#444444
    classDef step fill:#88BBBB,color:#003333,stroke:#226666
    classDef output fill:#FFE3AA,color:#553900,stroke:#AA8439
    class ω,m,un,h input
    class gf,ls,mvp,int step
    class f output
    </pre><figcaption>
<p><span class="caption-number">Fig. 2 </span><span class="caption-text">A simplified flowchart of the internals of Capytaine solver</span><a class="headerlink" href="#id19" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="problem-with-forward-speed">
<h2><a class="toc-backref" href="#id39" role="doc-backlink">Problem with forward speed</a><a class="headerlink" href="#problem-with-forward-speed" title="Link to this heading">¶</a></h2>
<p>We refer to <a class="reference internal" href="bibliography.html#d22" id="id17"><span>[D22]</span></a> for a detailed description of the theory behind the approximate forward speed model used in Capytaine.</p>
<p>It relies on the following hypotheses:</p>
<ol class="arabic simple">
<li><p>The magnitude <span class="math notranslate nohighlight">\(U\)</span> of the forward speed is small.</p></li>
<li><p>The body is thin enough, such that the flow around the body assuming a rigid free surface (also called <em>double-body flow</em>) can be approximated by <span class="math notranslate nohighlight">\(\overrightarrow{u} = (-U, 0, 0)\)</span> in the reference frame of the body.</p></li>
</ol>
<p>Then, the following modification are done to the solver to take forward speed into account:</p>
<ol class="arabic simple">
<li><p><strong>Doppler shift:</strong> The frequency used in the computation is replaced by the <em>encounter frequency</em></p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-31">
<span class="eqno">(60)<a class="headerlink" href="#equation-theory-manual-theory-31" title="Link to this equation">¶</a></span>\[\omega_e = \omega - k U \cos (\beta)\]</div>
<p>where <span class="math notranslate nohighlight">\(k\)</span> is the wavenumber and <span class="math notranslate nohighlight">\(\beta\)</span> is the wave direction.
For this purpose, the <code class="docutils literal notranslate"><span class="pre">wave_direction</span></code> parameter can be passed to radiation problem.</p>
<ol class="arabic simple" start="2">
<li><p><strong>Normal velocity on hull:</strong> The boundary condition on the body radiating with a dof defined by the displacement <span class="math notranslate nohighlight">\(\delta\!r(x, y, z)\)</span> reads</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-32">
<span class="eqno">(61)<a class="headerlink" href="#equation-theory-manual-theory-32" title="Link to this equation">¶</a></span>\[\frac{\partial \phi}{\partial n} = - i \omega_e \delta\!r \cdot n + U \frac{\partial \delta\! r}{\partial x} \cdot n\]</div>
<p>The above relationship has currently only been implemented for the six dofs of single rigid bodies, as follows</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Dof</p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\delta \! r\)</span></p></th>
<th class="head"><p><span class="math notranslate nohighlight">\(\frac{\partial \delta\! r}{\partial x}\)</span></p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Surge</p></td>
<td><p><span class="math notranslate nohighlight">\((1, 0, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Sway</p></td>
<td><p><span class="math notranslate nohighlight">\((0, 1, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 0)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Heave</p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 1)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Roll</p></td>
<td><p><span class="math notranslate nohighlight">\((0, -z, y)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 0)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Pitch</p></td>
<td><p><span class="math notranslate nohighlight">\((-z, 0, x)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, 0, 1)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Yaw</p></td>
<td><p><span class="math notranslate nohighlight">\((y, -x, 0)\)</span></p></td>
<td><p><span class="math notranslate nohighlight">\((0, -1, 0)\)</span></p></td>
</tr>
</tbody>
</table>
<p>In other words, the supplementary term is zero except for pitch and yaw.</p>
<ol class="arabic simple" start="3">
<li><p><strong>Gradient of potential in pressure:</strong> The equation relating the potential to the pressure is updated as follows</p></li>
</ol>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-33">
<span class="eqno">(62)<a class="headerlink" href="#equation-theory-manual-theory-33" title="Link to this equation">¶</a></span>\[p = -\rho \left( -i \omega_e \phi + U \frac{\partial \phi}{\partial x} \right)\]</div>
<p>Similarly the relationship between the potential and the free surface elevation reads</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-34">
<span class="eqno">(63)<a class="headerlink" href="#equation-theory-manual-theory-34" title="Link to this equation">¶</a></span>\[\eta = -\frac{1}{g} \left( -i \omega_e \phi + U \frac{\partial \phi}{\partial x} \right)\]</div>
<p>The computation of <span class="math notranslate nohighlight">\(\frac{\partial \phi}{\partial x}\)</span> makes the problems with forward speed typically 50% slower that problems without.</p>
<p>The overall workflow with forward speed thus looks as follows.</p>
<figure class="align-default" id="id20">
<pre  class="mermaid">
        graph TD
      h[Water depth] --&gt; gf(Assembling matrices);
      omega[Wave frequency ω] --&gt; doppler(Doppler shift);
      fs[Forward speed U] --&gt; doppler(Doppler shift);
      fs --&gt; un;
      doppler -- Encounter frequency --&gt; gf(Assembling matrices)
      m[Mesh] --&gt; gf;
      gf -- K matrix --&gt; ls(Linear solver);
      dof[Degree of freedom] --&gt; un(Normal velocity on hull);
      un --  RHS of linear problem --&gt; ls;
      gf -- S matrix --&gt; mvp(Matrix vector product);
      ls -- sources distribution σ --&gt; mvp;
      ls -- sources distribution σ --&gt; grad;
      gf -- extended K matrix --&gt; grad;
      mvp -- potential distribution Φ --&gt; int(&quot;Integrate pressure on mesh&quot;);
      grad(Matrix vector product) -- gradient of Φ --&gt; int;
      m --&gt; int;
      fs --&gt; int;
      int --&gt; f[&quot;Hydrodynamic forces&quot;]

      classDef input fill:#DDDDDD,color:#333333,stroke:#444444
      classDef step fill:#88BBBB,color:#003333,stroke:#226666
      classDef newstep fill:#FFAAAA,color:#550000,stroke:#113939
      classDef output fill:#FFE3AA,color:#553900,stroke:#AA8439
      class fs,omega,m,h,dof input
      class doppler,un,grad newstep
      class gf,ls,mvp,int step
      class f output
    </pre><figcaption>
<p><span class="caption-number">Fig. 3 </span><span class="caption-text">A simplified flowchart of the internals of Capytaine solver <strong>with forward speed</strong>, where red boxes are the supplementary steps introduced by forward speed.</span><a class="headerlink" href="#id20" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="post-processing">
<h2><a class="toc-backref" href="#id40" role="doc-backlink">Post-processing</a><a class="headerlink" href="#post-processing" title="Link to this heading">¶</a></h2>
<section id="forces-on-body-surfaces">
<h3><a class="toc-backref" href="#id41" role="doc-backlink">Forces on body surfaces</a><a class="headerlink" href="#forces-on-body-surfaces" title="Link to this heading">¶</a></h3>
<p>Forces acting on body surfaces are computed by integration of the pressure field.</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-35">
<span class="eqno">(64)<a class="headerlink" href="#equation-theory-manual-theory-35" title="Link to this equation">¶</a></span>\[F_i = \int_\Gamma p(x) \, n(x) \cdot \delta\!r_i(x) \, dx = j \omega \rho \int_\Gamma \Phi(x) \, n(x) \cdot \delta\!r_i(x) \, dx\]</div>
<p>where <span class="math notranslate nohighlight">\(p = j \omega \rho \Phi\)</span> stands for the complex-valued pressure fields in frequency-domain, <span class="math notranslate nohighlight">\(n\)</span> is the normal vector on the hull <span class="math notranslate nohighlight">\(\Gamma\)</span> (oriented towards the fluid in Capytaine, see <a class="reference internal" href="../user_manual/conventions.html"><span class="doc">Conventions and differences to other codes</span></a>) and <span class="math notranslate nohighlight">\(\delta\!r_i\)</span> is the local displacement of the hull of the degree of freedom <span class="math notranslate nohighlight">\(i\)</span>.</p>
<p>For a single rigid body, the degrees of freedom reads:</p>
<table class="docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Dof</p></th>
<th class="head"><p>Local hull displacement</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Surge</p></td>
<td><p><span class="math notranslate nohighlight">\(\delta\!r(x) = (1, 0, 0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Sway</p></td>
<td><p><span class="math notranslate nohighlight">\(\delta\!r(x) = (0, 1, 0)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Heave</p></td>
<td><p><span class="math notranslate nohighlight">\(\delta\!r(x) = (0, 0, 1)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Roll</p></td>
<td><p><span class="math notranslate nohighlight">\(\delta\!r(x) = (1, 0, 0) \times (x-x_0, y-y_0, z-z_0)\)</span></p></td>
</tr>
<tr class="row-even"><td><p>Pitch</p></td>
<td><p><span class="math notranslate nohighlight">\(\delta\!r(x) = (0, 1, 0) \times (x-x_0, y-y_0, z-z_0)\)</span></p></td>
</tr>
<tr class="row-odd"><td><p>Yaw</p></td>
<td><p><span class="math notranslate nohighlight">\(\delta\!r(x) = (0, 0, 1) \times (x-x_0, y-y_0, z-z_0)\)</span></p></td>
</tr>
</tbody>
</table>
<p>where <span class="math notranslate nohighlight">\((x_0, y_0, z_0)\)</span> is the rotation center and <span class="math notranslate nohighlight">\(\times\)</span> denotes the cross product.</p>
<p>The potential field can be decomposed into three contributions, and so does the resulting force:</p>
<ol class="arabic simple">
<li><p>The Froude-Krylov forces <span class="math notranslate nohighlight">\(F_{FK}\)</span>, from the integration of the
incident wave field pressure (incoming plane waves). In Capytaine, the
incident wave pressure can be retrieved with the
<code class="xref py py-func docutils literal notranslate"><span class="pre">airy_wave_pressure()</span></code> function.</p></li>
<li><p>The diffraction forces <span class="math notranslate nohighlight">\(F_{D}\)</span>, from the integration of the diffracted
wave field (all bodies held fixed).</p></li>
<li><p>The radiation forces <span class="math notranslate nohighlight">\(F_{R}\)</span>, which is itself a linear combination of
the forces exerted by the fluid on the body in response to a motion of each
degree of freedom.</p></li>
</ol>
<p>The component <span class="math notranslate nohighlight">\(i\)</span> of the radiation force <span class="math notranslate nohighlight">\(F_{R}\)</span> is further rewritten as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-36">
<span class="eqno">(65)<a class="headerlink" href="#equation-theory-manual-theory-36" title="Link to this equation">¶</a></span>\[F_{R, i} = \sum_k \left[\omega^2 A_{ik} + j \omega B_{ik}\right] X_k\]</div>
<p>where <span class="math notranslate nohighlight">\(A_{ik}\)</span> is the added mass matrix, <span class="math notranslate nohighlight">\(B_{ik}\)</span> is the radiation
damping matrix and <span class="math notranslate nohighlight">\(X_k\)</span> is the amplitude of the motion of the body along
the degree of freedom <span class="math notranslate nohighlight">\(k\)</span>.</p>
<p>In other words, one has</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-37">
<span class="eqno">(66)<a class="headerlink" href="#equation-theory-manual-theory-37" title="Link to this equation">¶</a></span>\[\begin{split}A_{ik} &amp; = \frac{1}{\omega^2} \Re \left[ j \omega \rho \int_\Gamma \Phi_k(x) \, n(x) \cdot \delta \! r_i(x) \, dx \right] \\
       &amp; = - \frac{\rho}{\omega} \int_\Gamma \Im [\Phi_k(x)] \, n(x) \cdot \delta \! r_i(x) \, dx\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-38">
<span class="eqno">(67)<a class="headerlink" href="#equation-theory-manual-theory-38" title="Link to this equation">¶</a></span>\[\begin{split}B_{ik} &amp; = \frac{1}{\omega} \Im \left[ j \omega \rho \int_\Gamma \Phi_k(x) \, n(x) \cdot \delta \! r_i(x) \, dx \right] \\
       &amp; = \rho \int_\Gamma \Re [\Phi_k(x)] \, n(x) \cdot \delta \! r_i(x) \, dx\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\Phi_k\)</span> is the potential field computed with the normal velocity on the hull <span class="math notranslate nohighlight">\(\frac{\partial \Phi_k}{\partial n} = -j \omega \delta \! r_k \cdot n\)</span>.
In Capytaine’s wording, the degree of freedom <span class="math notranslate nohighlight">\(k\)</span> defining the normal velocity on the hull is called <code class="docutils literal notranslate"><span class="pre">radiating_dof</span></code>, while the degree of freedom <span class="math notranslate nohighlight">\(i\)</span> used in the integration of the force is the <code class="docutils literal notranslate"><span class="pre">influenced_dof</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>From Green second identity</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-39">
<span class="eqno">(68)<a class="headerlink" href="#equation-theory-manual-theory-39" title="Link to this equation">¶</a></span>\[\int_\Gamma \left[ \Phi_i \frac{\partial \Phi_k}{\partial n} - \Phi_k \frac{\partial \Phi_i}{\partial n}\right] dx = 0\]</div>
<p>one has, when using the definition of the normal velocity of the radiation problem above,</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-40">
<span class="eqno">(69)<a class="headerlink" href="#equation-theory-manual-theory-40" title="Link to this equation">¶</a></span>\[\iint_{\Gamma} \Phi_i \; \delta\!r_k \cdot n = \iint_{\Gamma} \Phi_k \; \delta\!r_i \cdot n\]</div>
<p>from which we can deduce the symmetry of the added mass matrix and the radiation dampings matrix.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As an alternative to <span class="math notranslate nohighlight">\(\frac{\partial \Phi_k}{\partial n} = -j \omega
\delta \! r_k \cdot n\)</span>, some software such as the version 1 of Capytaine use
<span class="math notranslate nohighlight">\(\frac{\partial \tilde \Phi_k}{\partial n} = \delta \! r_k \cdot n\)</span>,
that is <span class="math notranslate nohighlight">\(\tilde \Phi_k = \frac{\Phi_k}{-j \omega}\)</span>.</p>
<p>It leads to the following definition of the added mass and radiation damping</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-41">
<span class="eqno">(70)<a class="headerlink" href="#equation-theory-manual-theory-41" title="Link to this equation">¶</a></span>\[\begin{split}A_{ik} &amp; = \frac{1}{\omega^2} \Re \left[ j \omega \rho \int_\Gamma (- j \omega \tilde \Phi_k(x)) \, n(x) \cdot \delta \! r_j(x) \, dx \right] \\
       &amp; = \rho \int_\Gamma \Re [\tilde \Phi_k(x)] \, n(x) \cdot \delta \! r_j(x) \, dx\end{split}\]</div>
<p>and</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-42">
<span class="eqno">(71)<a class="headerlink" href="#equation-theory-manual-theory-42" title="Link to this equation">¶</a></span>\[\begin{split}B_{ik} &amp; = \frac{1}{\omega} \Im \left[ j \omega \rho \int_\Gamma (- j \omega \tilde \Phi_k(x)) \, n(x) \cdot \delta \! r_j(x) \, dx \right] \\
       &amp; = \rho \omega \int_\Gamma \Im [\tilde \Phi_k(x)] \, n(x) \cdot \delta \! r_j(x) \, dx\end{split}\]</div>
<p>This form is convenient since the all the <span class="math notranslate nohighlight">\(\omega\)</span> in the expression
of the added mass disappears, which make it possible to compute the value of
the added mass at frequency such as zero or infinity.</p>
<p>However, the implementation of <span class="math notranslate nohighlight">\(\tilde \Phi\)</span> in version 1 of Capytaine
was not consistent with the use of <span class="math notranslate nohighlight">\(\Phi\)</span> for diffraction problem and
it was easy to forget the missing <span class="math notranslate nohighlight">\(-j\omega\)</span> for some post-processing
of <span class="math notranslate nohighlight">\(\tilde \Phi\)</span> for radiation problems.</p>
<p>In version 2.0 of Capytaine, <span class="math notranslate nohighlight">\(\Phi\)</span> is used everywhere instead of
<span class="math notranslate nohighlight">\(\tilde \Phi\)</span>.
Since version 2.1, another method has been implemented to take into account
the cancelling of the <span class="math notranslate nohighlight">\(\omega\)</span> in the expression of the added mass
allowing to compute the added mass at zero and infinite frequency.</p>
</div>
</section>
<section id="dynamic-coupling-and-impedance">
<h3><a class="toc-backref" href="#id42" role="doc-backlink">Dynamic coupling and impedance</a><a class="headerlink" href="#dynamic-coupling-and-impedance" title="Link to this heading">¶</a></h3>
<p>Consider a body or a system of bodies. The general linear equation of motion can be expressed in time domain as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-43">
<span class="eqno">(72)<a class="headerlink" href="#equation-theory-manual-theory-43" title="Link to this equation">¶</a></span>\[M_{ij} \ddot{x}_j + C_{ij} \dot{x}_j + K_{ij} x_j = F_i,\]</div>
<p>and in frequency domain, with the assumed time dependence <span class="math notranslate nohighlight">\(x(t) = \mathrm{Re} \left( X e^{-j \omega t} \right)\)</span>,</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-44">
<span class="eqno">(73)<a class="headerlink" href="#equation-theory-manual-theory-44" title="Link to this equation">¶</a></span>\[\left[-\omega^2M_{ij} - j \omega C_{ij} + K_{ij}\right] X_j = F_i,\]</div>
<p>where <span class="math notranslate nohighlight">\(M_{ij}\)</span> is the inertia matrix, accounting for the mass distribution, <span class="math notranslate nohighlight">\(C_{ij}\)</span> is the mechanical damping matrix, <span class="math notranslate nohighlight">\(K_{ij}\)</span> is the stiffness matrix which comprises mechanical and hydrostatic effects, and <span class="math notranslate nohighlight">\(F_i\)</span> are generic external forces.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The hydrostatic contribution to matrix <span class="math notranslate nohighlight">\(K_{ij}\)</span> accounts for a variation of hydrostatic force in direction <span class="math notranslate nohighlight">\(i\)</span> due to a unit motion in direction <span class="math notranslate nohighlight">\(j\)</span>. It is a geometric property of the body.</p>
</div>
<p>As seen above, forces <span class="math notranslate nohighlight">\(F_i\)</span> can be decomposed as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-45">
<span class="eqno">(74)<a class="headerlink" href="#equation-theory-manual-theory-45" title="Link to this equation">¶</a></span>\[F_i = F_{FK, i} + F_{D, i} + F_{R, i}\]</div>
<p>The full system becomes</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-46">
<span class="eqno">(75)<a class="headerlink" href="#equation-theory-manual-theory-46" title="Link to this equation">¶</a></span>\[\left[-\omega^2 (M_{ij} + A_{ij}) - j \omega (C_{ij} + B_{ij}) + K_{ij}\right] X_j = F_{FK, i} + F_{D, i}\]</div>
<p>that is</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-47">
<span class="eqno">(76)<a class="headerlink" href="#equation-theory-manual-theory-47" title="Link to this equation">¶</a></span>\[H X = F_{ex}\]</div>
<p>where <span class="math notranslate nohighlight">\(H\)</span> denotes the following transfer function matrix</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-48">
<span class="eqno">(77)<a class="headerlink" href="#equation-theory-manual-theory-48" title="Link to this equation">¶</a></span>\[H_{ij} = \left[-\omega^2 (M_{ij} + A_{ij}) - j \omega (C_{ij} + B_{ij}) + K_{ij}\right]\]</div>
<p>and <span class="math notranslate nohighlight">\(F_{ex}\)</span> denotes the excitation force.</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-49">
<span class="eqno">(78)<a class="headerlink" href="#equation-theory-manual-theory-49" title="Link to this equation">¶</a></span>\[F_{ex, i} = F_{FK, i} + F_{D, i}.\]</div>
<p>The oscillation amplitude is obtained by solving the complex-valued linear system.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Matrices <span class="math notranslate nohighlight">\(A_{ij}\)</span> and <span class="math notranslate nohighlight">\(B_{ij}\)</span> depend on <span class="math notranslate nohighlight">\(\omega\)</span>, and so does <span class="math notranslate nohighlight">\(H_{ij}\)</span> and <span class="math notranslate nohighlight">\(X_j\)</span>.</p>
</div>
</section>
<section id="free-surface-elevation">
<h3><a class="toc-backref" href="#id43" role="doc-backlink">Free surface elevation</a><a class="headerlink" href="#free-surface-elevation" title="Link to this heading">¶</a></h3>
<p>The potential at the reference surface <span class="math notranslate nohighlight">\(z = 0\)</span> can be connected to the free surface elevation by the dynamic condition</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-50">
<span class="eqno">(79)<a class="headerlink" href="#equation-theory-manual-theory-50" title="Link to this equation">¶</a></span>\[\dfrac{\partial \phi}{\partial t} = - g \eta\]</div>
<p>which, in frequency domain, is</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-51">
<span class="eqno">(80)<a class="headerlink" href="#equation-theory-manual-theory-51" title="Link to this equation">¶</a></span>\[\eta = \dfrac{j \omega}{g} \Phi\]</div>
<p>For a fully coupled problem (bodies free to oscillate, i.e. diffraction and radiation combined), the free surface elevation can be computed as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-52">
<span class="eqno">(81)<a class="headerlink" href="#equation-theory-manual-theory-52" title="Link to this equation">¶</a></span>\[\eta = \eta_{\text{incident}} + \eta_{\text{diffracted}} + \sum_i \eta_{\text{radiated}, i} X_i.\]</div>
</section>
<section id="far-field-coefficients">
<h3><a class="toc-backref" href="#id44" role="doc-backlink">Far-field coefficients</a><a class="headerlink" href="#far-field-coefficients" title="Link to this heading">¶</a></h3>
<p>Far from the floating body, the potential of an infinite depth problem can be written as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-53">
<span class="eqno">(82)<a class="headerlink" href="#equation-theory-manual-theory-53" title="Link to this equation">¶</a></span>\[\Phi(x) \sim - \sqrt{\frac{2 \pi k}{\rho(x)}} e^{k x_3} H(\theta(x)) e^{i k \rho(x)} e^{i \pi/4} + O\left(\frac{1}{\rho(x)}\right)\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho(x)\)</span> and <span class="math notranslate nohighlight">\(\theta(x)\)</span> are the cylindrical coordinates of <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(H\)</span> is the so-called Kochin function which can be computed as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-54">
<span class="eqno">(83)<a class="headerlink" href="#equation-theory-manual-theory-54" title="Link to this equation">¶</a></span>\[H(\theta) = \frac{1}{4 \pi} \int_\Gamma \sigma(\xi) e^{k \xi_3} e^{- i k (\xi_1 \cos \theta + \xi_2 \sin \theta)} \, d \xi\]</div>
<div class="proof admonition" id="proof">
<p>Proof. Let us first note, following <a class="reference internal" href="bibliography.html#del87" id="id18"><span>[Del87]</span></a> (p.79), that for large <span class="math notranslate nohighlight">\(\rho(x)\)</span>:</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-55">
\begin{align*}
r &amp; = \sqrt{(x_1 - \xi_1)^2 + (x_2 - \xi_2)^2} \\
  &amp; = \sqrt{\rho(x)^2 + \rho(\xi)^2 - 2 \rho(x) \rho(\xi) \cos(\theta(x) - \theta(\xi))} \\
  &amp; \sim \rho(x) - \rho(\xi) \cos(\theta(x) - \theta(\xi)) \\
  &amp; \sim \rho(x) - (\xi_1 \cos\theta(x) + \xi_2 \sin\theta(x))
\end{align*}</div><p>Then the asymptotic behavior of the infinite depth Green function <a class="reference internal" href="#equation-green-function-asymptotical-approx">(56)</a> reads</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-56">
<span class="eqno">(85)<a class="headerlink" href="#equation-theory-manual-theory-56" title="Link to this equation">¶</a></span>\[- 4 \pi G(x, \xi) \sim 2 k \sqrt{\frac{\pi}{k r}} e^{k z + i k r}(1+i) + O\left(\frac{1}{r}\right)\]</div>
<p>which can be rewritten as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-57">
<span class="eqno">(86)<a class="headerlink" href="#equation-theory-manual-theory-57" title="Link to this equation">¶</a></span>\[- 4 \pi G(x, \xi) \sim \sqrt{\frac{2 \pi k}{\rho(x)}} e^{k z + i k (\rho(x) - (\xi_1 \cos\theta(x) + \xi_2 \sin\theta(x))} e^{i\pi/4} + O\left(\frac{1}{\rho(x)}\right)\]</div>
<p>Incorporating into the source representation <a class="reference internal" href="#equation-potential-representation">(21)</a>, we have</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-58">
<span class="eqno">(87)<a class="headerlink" href="#equation-theory-manual-theory-58" title="Link to this equation">¶</a></span>\[\Phi \sim - e^{k x_3} e^{ik\rho(x)} e^{i \pi/4} \sqrt{\frac{2\pi k}{\rho(x)}} \underbrace{\frac{1}{4\pi} \int_\Gamma \sigma(\xi) e^{k \xi_3} e^{-ik(\xi_1 \cos \theta + \xi_2 \sin \theta))} d\xi}_{H(\theta)}\]</div>
</div>
<p>Capytaine computes the Kochin function in finite depth as</p>
<div class="math notranslate nohighlight" id="equation-theory-manual-theory-59">
<span class="eqno">(88)<a class="headerlink" href="#equation-theory-manual-theory-59" title="Link to this equation">¶</a></span>\[H(\theta) = \frac{1}{4 \pi} \int_\Gamma \sigma(\xi) \frac{\cosh (k (\xi_3+h))}{\cosh (k h)} e^{- i k (\xi_1 \cos \theta + \xi_2 \sin \theta)} \, d \xi\]</div>
<p>Note that other work might define the Kochin function slightly differently, with a different normalization.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>

      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="../index.html">capytaine</a></h1>



<p class="blurb">a Python-based linear potential flow BEM solver</p>









<search id="searchbox" style="display: none" role="search">
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" placeholder="Search"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script><h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../features.html">Features</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../user_manual/index.html">User manual</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../examples/index.html">Example scripts</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../developer_manual/index.html">Developer manual</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Theory manual</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Theory manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../citing.html">Citing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../changelog.html">Changelog</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="index.html">Theory manual</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Theory manual</a></li>
      <li>Next: <a href="bibliography.html" title="next chapter">Bibliography</a></li>
  </ul></li>
  </ul></li>
</ul>
</div>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &#169;2024, Matthieu Ancellin.
      
      |
      Powered by <a href="https://www.sphinx-doc.org/">Sphinx 8.2.3</a>
      &amp; <a href="https://alabaster.readthedocs.io">Alabaster 1.0.0</a>
      
      |
      <a href="../_sources/theory_manual/theory.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>